{"version":3,"file":"vue3-calendar-heatmap.es.js","sources":["../src/components/Heatmap.ts","../src/components/CalendarHeatmap.vue","../src/components/CalendarHeatmap.vue","../src/index.ts"],"sourcesContent":["export interface Value {\n\tdate: Date | string;\n\tcount: number;\n}\n\nexport interface Activity {\n\tcount: number;\n\tcolorIndex: number;\n}\n\nexport type Activities = Map<string, Activity>;\n\nexport interface CalendarItem {\n\tdate: Date;\n\tcount?: number;\n\tcolorIndex: number;\n}\n\n// Indexed originally, first by week then by day\n// Indexed originally, first by half-year then by month\nexport type Calendar = CalendarItem[][];\n\nexport interface Month {\n\tvalue: number;\n\tindex: number;\n}\n\nexport interface Locale {\n\tmonths: string[];\n\tdays: string[];\n\ton: string;\n\tless: string;\n\tmore: string;\n}\n\nexport type TooltipFormatter = (item: CalendarItem, unit: string) => string;\n\nexport class Heatmap {\n\n\tstatic readonly DEFAULT_RANGE_COLOR_LIGHT = ['#ebedf0', '#dae2ef', '#c0ddf9', '#73b3f3', '#3886e1', '#17459e'];\n\tstatic readonly DEFAULT_RANGE_COLOR_DARK = ['#1f1f22', '#1e334a', '#1d466c', '#1d5689', '#1d69ac', '#1B95D1'];\n\t// other color candidates\n\t// static readonly DEFAULT_RANGE_COLOR_LIGHT = [ '#ebedf0', '#9be9a8', '#40c463', '#30a14e', '#216e39' ];\n\t// static readonly DEFAULT_RANGE_COLOR_DARK  = [ '#161b22', '#0e4429', '#006d32', '#26a641', '#39d353' ];\n\t// static readonly DEFAULT_RANGE_COLOR_DARK    = [ '#011526', '#012E40', '#025959', '#02735E', '#038C65' ];\n\t// static readonly DEFAULT_RANGE_COLOR_DARK    = [ '#161b22', '#015958', '#008F8C', '#0CABA8', '#0FC2C0' ];\n\t// static readonly DEFAULT_RANGE_COLOR_DARK    = [ '#012030', '#13678A', '#45C4B0', '#9AEBA3', '#DAFDBA' ];\n\tstatic readonly DEFAULT_LOCALE: Locale = {\n\t\tmonths: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'],\n\t\tdays: ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'],\n\t\ton: 'on',\n\t\tless: 'Less',\n\t\tmore: 'More'\n\t};\n\tstatic readonly DEFAULT_TOOLTIP_UNIT = 'contributions';\n\tstatic readonly DAYS_IN_ONE_YEAR = 365;\n\tstatic readonly DAYS_IN_WEEK = 7;\n\tstatic readonly MONTHS_IN_ONE_YEAR = 12;\n\tstatic readonly MONTHS_IN_ROW = 6;\n\tstatic readonly SQUARE_SIZE = 10;\n\n\tstartDate: Date;\n\tendDate: Date;\n\tmax: number;\n\tnumSlices: number;\n\tnumItems: number;\n\n\tprivate _values: Value[];\n\tprivate _firstFullWeekOfMonths?: Month[];\n\tprivate _yearsToHaveInLabels?: number[];\n\tprivate _activities?: Activities;\n\tprivate _calendar?: Calendar;\n\n\tconstructor(endDate: Date | string, values: Value[], max?: number, startDate?: Date | string) {\n\t\tthis.endDate = this.parseDate(endDate);\n\n\t\tthis.max = max || Math.ceil((Math.max(...values.map(day => day.count)) / 5) * 4);\n\n\t\tif (startDate)\n\t\t\tthis.startDate = new Date(startDate);\n\t\telse {\n\t\t\tconst oldest = values.length > 0 ? Math.min(...values.map(v => this.parseDate(v.date).getFullYear())) : new Date().getFullYear() - 10\n\t\t\tthis.startDate = new Date();\n\t\t\tthis.startDate.setFullYear(oldest);\n\t\t}\n\n\n\t\tthis.numSlices = (this.endDate.getFullYear() - this.startDate.getFullYear() + 1) * 2;\n\t\tthis.numItems = Heatmap.MONTHS_IN_ROW;\n\n\t\tthis._values = values;\n\t}\n\n\tset values(v: Value[]) {\n\t\tthis.max = Math.ceil((Math.max(...v.map(day => day.count)) / 5) * 4);\n\t\tthis._values = v;\n\t\tthis._firstFullWeekOfMonths = undefined;\n\t\tthis._yearsToHaveInLabels = undefined;\n\t\tthis._calendar = undefined;\n\t\tthis._activities = undefined;\n\t}\n\n\tget values(): Value[] {\n\t\treturn this._values;\n\t}\n\n\tget activities(): Activities {\n\t\tif (!this._activities) {\n\t\t\tthis._activities = new Map();\n\t\t\tfor (let i = 0, len = this.values.length; i < len; i++) {\n\t\t\t\t//this._activities.set(this.keyDayParser(this.values[i].date), {\n\n\t\t\t\t// additive\n\t\t\t\tconst key = this.keyMonthParser(this.values[i].date);\n\t\t\t\tconst newCount = (this._activities.get(key)?.count || 0) + this.values[i].count\n\t\t\t\tthis._activities.set(key, {\n\t\t\t\t\tcount: newCount,\n\t\t\t\t\tcolorIndex: this.getColorIndex(newCount)\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t\treturn this._activities;\n\t}\n\n\tget calendar() {\n\t\tif (!this._calendar) {\n\t\t\t//let date = this.shiftDate(this.startDate, -this.getCountEmptyDaysAtStart());\n\t\t\t//date = new Date(date.getFullYear(), date.getMonth(), date.getDate());\n\t\t\tlet date = new Date(this.startDate.getFullYear(), 0, 1);\n\t\t\t//this._calendar = new Array(this.weekCount);\n\t\t\tthis._calendar = new Array(this.numSlices);\n\t\t\tfor (let i = 0, len = this._calendar.length; i < len; i++) {\n\t\t\t\t//this._calendar[i] = new Array(Heatmap.DAYS_IN_WEEK);\n\t\t\t\tthis._calendar[i] = new Array(this.numItems);\n\t\t\t\t//for (let j = 0; j < Heatmap.DAYS_IN_WEEK; j++) {\n\t\t\t\tfor (let j = 0; j < this.numItems; j++) {\n\t\t\t\t\t//const dayValues = this.activities.get(this.keyDayParser(date));\n\t\t\t\t\tconst monthValues = this.activities.get(this.keyMonthParser(date));\n\t\t\t\t\tthis._calendar![i][j] = {\n\t\t\t\t\t\tdate: new Date(date.valueOf()),\n\t\t\t\t\t\tcount: monthValues ? monthValues.count : undefined,\n\t\t\t\t\t\tcolorIndex: monthValues ? monthValues.colorIndex : 0\n\t\t\t\t\t};\n\t\t\t\t\t//date.setDate(date.getDate() + 1);\n\t\t\t\t\tdate.setMonth(date.getMonth() + 1);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tconsole.log(this._calendar)\n\t\treturn this._calendar;\n\t}\n\n\tget yearsToHaveInlabels(): number[] {\n\t\tif (!this._yearsToHaveInLabels) {\n\t\t\tthis._yearsToHaveInLabels = [];\n\n\t\t\tlet year = this.startDate.getFullYear();\n\t\t\tconst lastYear = this.endDate.getFullYear();\n\t\t\tconsole.log(year, lastYear);\n\t\t\twhile (year <= lastYear) {\n\t\t\t\tthis._yearsToHaveInLabels.push(year)\n\t\t\t\tyear++\n\t\t\t}\n\t\t}\n\t\tconsole.log(\"Years to have in labels\", this._yearsToHaveInLabels)\n\t\treturn this._yearsToHaveInLabels;\n\t}\n\n\tget firstFullWeekOfMonths(): Month[] {\n\t\tif (!this._firstFullWeekOfMonths) {\n\t\t\tconst cal = this.calendar;\n\t\t\tthis._firstFullWeekOfMonths = [];\n\t\t\tfor (let index = 1, len = cal.length; index < len; index++) {\n\t\t\t\tconst lastWeek = cal[index - 1][0].date,\n\t\t\t\t\tcurrentWeek = cal[index][0].date;\n\t\t\t\tif (lastWeek.getFullYear() < currentWeek.getFullYear() || lastWeek.getMonth() < currentWeek.getMonth()) {\n\t\t\t\t\tthis._firstFullWeekOfMonths.push({ value: currentWeek.getMonth(), index });\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn this._firstFullWeekOfMonths;\n\t}\n\n\tgetColorIndex(count?: number) {\n\t\tif (count === null || count === undefined) {\n\t\t\treturn 0;\n\t\t} else if (count <= 0) {\n\t\t\treturn 1;\n\t\t} else if (count >= this.max) {\n\t\t\treturn 5;\n\t\t} else {\n\t\t\treturn (Math.ceil(((count * 100) / this.max) * (0.03))) + 1;\n\t\t}\n\t}\n\n\tgetCountEmptyDaysAtStart() {\n\t\treturn this.startDate.getDay();\n\t}\n\n\tgetCountEmptyDaysAtEnd() {\n\t\treturn (Heatmap.DAYS_IN_WEEK - 1) - this.endDate.getDay();\n\t}\n\n\tgetDaysCount() {\n\t\treturn Heatmap.DAYS_IN_ONE_YEAR + 1 + this.getCountEmptyDaysAtStart() + this.getCountEmptyDaysAtEnd();\n\t}\n\n\tprivate shiftDate(date: Date | string, numDays: number) {\n\t\tconst newDate = new Date(date);\n\t\tnewDate.setDate(newDate.getDate() + numDays);\n\t\treturn newDate;\n\t}\n\n\tprivate parseDate(entry: Date | string) {\n\t\treturn (entry instanceof Date) ? entry : (new Date(entry));\n\t}\n\n\tprivate keyDayParser(date: Date | string) {\n\t\tconst day = this.parseDate(date);\n\t\treturn String(day.getFullYear()) + String(day.getMonth()).padStart(2, '0') + String(day.getDate()).padStart(2, '0');\n\t}\n\tprivate keyMonthParser(date: Date | string) {\n\t\tconst day = this.parseDate(date);\n\t\treturn String(day.getFullYear()) + String(day.getMonth()).padStart(2, '0');\n\t}\n\n}\n","<template>\n\t<div :class=\"{'vch__container': true, 'dark-mode': darkMode}\">\n\t\t<svg class=\"vch__wrapper\" ref=\"svg\" :viewBox=\"viewbox\">\n\t\t\t<g class=\"vch__months__labels__wrapper\" :transform=\"monthsLabelWrapperTransform\">\n\t\t\t\t<text\n\t\t\t\t\tclass=\"vch__month__label\"\n\t\t\t\t\tv-for=\"(year, index) in heatmap.yearsToHaveInlabels\"\n\t\t\t\t\t:key=\"index\"\n\t\t\t\t\t:x=\"getYearLabelPosition(index).x\"\n\t\t\t\t\t:y=\"getYearLabelPosition(index).y\"\n\t\t\t\t>\n\t\t\t\t\t{{ year}}\n\t\t\t\t</text>\n\t\t\t</g>\n\n\t\t\t<!-- legend that has more, less and a few squares -->\n\t\t\t<g v-if=\"vertical\" class=\"vch__legend__wrapper\" :transform=\"legendWrapperTransform\">\n\t\t\t\t<text :x=\"SQUARE_SIZE * 1.25\" y=\"8\">{{ lo.less }}</text>\n\t\t\t\t<rect\n\t\t\t\t\tv-for=\"(color, index) in curRangeColor\"\n\t\t\t\t\t:key=\"index\"\n\t\t\t\t\t:rx=\"round\"\n\t\t\t\t\t:ry=\"round\"\n\t\t\t\t\t:style=\"{ fill: color }\"\n\t\t\t\t\t:width=\"SQUARE_SIZE - SQUARE_BORDER_SIZE\"\n\t\t\t\t\t:height=\"SQUARE_SIZE - SQUARE_BORDER_SIZE\"\n\t\t\t\t\t:x=\"SQUARE_SIZE * 1.75\"\n\t\t\t\t\t:y=\"SQUARE_SIZE * (index + 1)\"\n\t\t\t\t/>\n\t\t\t\t<text\n\t\t\t\t\t:x=\"SQUARE_SIZE * 1.25\"\n\t\t\t\t\t:y=\"SQUARE_SIZE * (curRangeColor.length + 2) - SQUARE_BORDER_SIZE\"\n\t\t\t\t>\n\t\t\t\t\t{{ lo.more }}\n\t\t\t\t</text>\n\t\t\t</g>\n\n\t\t\t<!-- colored boxes region -->\n\t\t\t<g class=\"vch__year__wrapper\" :transform=\"yearWrapperTransform\" @mouseover=\"initTippyLazy\">\n\t\t\t\t<g class=\"vch__slice__wrapper\"\n\t\t\t\t   v-for=\"(slice, sliceIndex) in heatmap.calendar\"\n\t\t\t\t   :key=\"sliceIndex\"\n\t\t\t\t   :transform=\"getSlicePosition(sliceIndex)\"\n\t\t\t\t>\n\t\t\t\t\t<!-- outer index is a slice, inner index is an item-->\n\t\t\t\t\t<template v-for=\"(item, itemIndex) in slice\" :key=\"itemIndex\">\n\t\t\t\t\t\t<rect class=\"vch__day__square\"\n\t\t\t\t\t\t\t  v-if=\"item.date < now\"\n\t\t\t\t\t\t\t  :rx=\"round\"\n\t\t\t\t\t\t\t  :ry=\"round\"\n\t\t\t\t\t\t\t  :transform=\"getItemPosition(itemIndex)\"\n\t\t\t\t\t\t\t  :width=\"SQUARE_SIZE - SQUARE_BORDER_SIZE\"\n\t\t\t\t\t\t\t  :height=\"SQUARE_SIZE - SQUARE_BORDER_SIZE\"\n\t\t\t\t\t\t\t  :style=\"{ fill: curRangeColor[item.colorIndex] }\"\n\t\t\t\t\t\t\t  :data-slice-index=\"sliceIndex\"\n\t\t\t\t\t\t\t  :data-item-index=\"itemIndex\"\n\t\t\t\t\t\t\t  @click=\"$emit('itemClick', item)\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t</template>\n\t\t\t\t</g>\n\t\t\t</g>\n\t\t</svg>\n\t\t<div class=\"vch__legend\">\n\t\t\t<slot name=\"legend\">\n\t\t\t\t<div class=\"vch__legend-left\">\n\t\t\t\t\t<slot name=\"vch__legend-left\"></slot>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"vch__legend-right\">\n\t\t\t\t\t<slot name=\"legend-right\">\n\t\t\t\t\t\t<div class=\"vch__legend\">\n\t\t\t\t\t\t\t<div>{{ lo.less }}</div>\n\t\t\t\t\t\t\t<svg v-if=\"!vertical\" class=\"vch__external-legend-wrapper\" :viewBox=\"legendViewbox\" :height=\"SQUARE_SIZE - SQUARE_BORDER_SIZE\">\n\t\t\t\t\t\t\t\t<g class=\"vch__legend__wrapper\">\n\t\t\t\t\t\t\t\t\t<rect\n\t\t\t\t\t\t\t\t\t\tv-for=\"(color, index) in curRangeColor\"\n\t\t\t\t\t\t\t\t\t\t:key=\"index\"\n\t\t\t\t\t\t\t\t\t\t:rx=\"round\"\n\t\t\t\t\t\t\t\t\t\t:ry=\"round\"\n\t\t\t\t\t\t\t\t\t\t:style=\"{ fill: color }\"\n\t\t\t\t\t\t\t\t\t\t:width=\"SQUARE_SIZE - SQUARE_BORDER_SIZE\"\n\t\t\t\t\t\t\t\t\t\t:height=\"SQUARE_SIZE - SQUARE_BORDER_SIZE\"\n\t\t\t\t\t\t\t\t\t\t:x=\"SQUARE_SIZE * index\"\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t</g>\n\t\t\t\t\t\t\t</svg>\n\t\t\t\t\t\t\t<div>{{ lo.more }}</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</slot>\n\t\t\t\t</div>\n\t\t\t</slot>\n\t\t</div>\n\t</div>\n</template>\n\n<script lang=\"ts\">\n\timport { defineComponent, nextTick, onBeforeUnmount, onMounted, PropType, ref, toRef, toRefs, watch } from 'vue';\n\timport { CalendarItem, Heatmap, Locale, Month, TooltipFormatter, Value } from '@/components/Heatmap';\n\timport tippy, { createSingleton, CreateSingletonInstance, Instance } from 'tippy.js';\n\timport 'tippy.js/dist/tippy.css';\n\timport 'tippy.js/dist/svg-arrow.css';\n\n\texport default /*#__PURE__*/defineComponent({\n\t\tname : 'CalendarHeatmap',\n\t\tprops: {\n\t\t\tendDate         : {\n\t\t\t\trequired: true\n\t\t\t},\n\t\t\tmax             : {\n\t\t\t\ttype: Number\n\t\t\t},\n\t\t\trangeColor      : {\n\t\t\t\ttype: Array as PropType<string[]>\n\t\t\t},\n\t\t\tvalues          : {\n\t\t\t\ttype    : Array as PropType<Value[]>,\n\t\t\t\trequired: true\n\t\t\t},\n\t\t\tlocale          : {\n\t\t\t\ttype: Object as PropType<Partial<Locale>>\n\t\t\t},\n\t\t\ttooltip         : {\n\t\t\t\ttype   : Boolean,\n\t\t\t\tdefault: true\n\t\t\t},\n\t\t\ttooltipUnit     : {\n\t\t\t\ttype   : String,\n\t\t\t\tdefault: Heatmap.DEFAULT_TOOLTIP_UNIT\n\t\t\t},\n\t\t\ttooltipFormatter: {\n\t\t\t\ttype: Function as PropType<TooltipFormatter>\n\t\t\t},\n\t\t\tvertical        : {\n\t\t\t\ttype   : Boolean,\n\t\t\t\tdefault: false\n\t\t\t},\n\t\t\tnoDataText      : {\n\t\t\t\ttype   : [ Boolean, String ],\n\t\t\t\tdefault: null\n\t\t\t},\n\t\t\tround           : {\n\t\t\t\ttype   : Number,\n\t\t\t\tdefault: 0\n\t\t\t},\n\t\t\tdarkMode        : Boolean\n\t\t},\n\t\temits: [ 'itemClick' ],\n\t\tsetup(props) {\n\n\t\t\tconst SQUARE_BORDER_SIZE          = Heatmap.SQUARE_SIZE / 5,\n\t\t\t\t  SQUARE_SIZE                 = Heatmap.SQUARE_SIZE + SQUARE_BORDER_SIZE,\n\t\t\t\t  LEFT_SECTION_WIDTH          = Math.ceil(Heatmap.SQUARE_SIZE * 2.5),\n\t\t\t\t  RIGHT_SECTION_WIDTH         = SQUARE_SIZE * 3,\n\t\t\t\t  TOP_SECTION_HEIGHT          = Heatmap.SQUARE_SIZE + (Heatmap.SQUARE_SIZE / 2),\n\t\t\t\t  BOTTOM_SECTION_HEIGHT       = Heatmap.SQUARE_SIZE + (Heatmap.SQUARE_SIZE / 2),\n\t\t\t\t  yearWrapperTransform        = `translate(${LEFT_SECTION_WIDTH}, ${TOP_SECTION_HEIGHT})`,\n\n\t\t\t\t  svg                         = ref<null | SVGElement>(null),\n\t\t\t\t  now                         = ref(new Date()),\n\t\t\t\t  heatmap                     = ref(new Heatmap(props.endDate as Date, props.values, props.max)),\n\n\t\t\t\t  width                       = ref(0),\n\t\t\t\t  height                      = ref(0),\n\t\t\t\t  viewbox                     = ref('0 0 0 0'),\n\t\t\t\t  legendViewbox               = ref('0 0 0 0'),\n\t\t\t\t  daysLabelWrapperTransform   = ref(''),\n\t\t\t\t  monthsLabelWrapperTransform = ref(''),\n\t\t\t\t  legendWrapperTransform      = ref(''),\n\t\t\t\t  lo                          = ref<Locale>({} as any),\n\t\t\t\t  rangeColor                  = ref<string[]>(props.rangeColor || (props.darkMode ? Heatmap.DEFAULT_RANGE_COLOR_DARK : Heatmap.DEFAULT_RANGE_COLOR_LIGHT));\n\n\t\t\tconst { values, tooltipUnit, tooltipFormatter, noDataText, max, vertical, locale } = toRefs(props),\n\t\t\t\t  tippyInstances                                                               = new Map<HTMLElement, Instance>();\n\n\t\t\tlet tippySingleton: CreateSingletonInstance;\n\n\n\t\t\tfunction initTippy() {\n\t\t\t\ttippyInstances.clear();\n\t\t\t\tif (tippySingleton) {\n\t\t\t\t\ttippySingleton.setInstances(Array.from(tippyInstances.values()));\n\t\t\t\t} else {\n\t\t\t\t\ttippySingleton = createSingleton(Array.from(tippyInstances.values()), {\n\t\t\t\t\t\toverrides     : [],\n\t\t\t\t\t\tmoveTransition: 'transform 0.1s ease-out',\n\t\t\t\t\t\tallowHTML     : true\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tfunction tooltipOptions(item: CalendarItem) {\n\t\t\t\tif (props.tooltip) {\n\t\t\t\t\tif (item.count !== undefined) {\n\t\t\t\t\t\tif (props.tooltipFormatter) {\n\t\t\t\t\t\t\treturn props.tooltipFormatter(item, props.tooltipUnit!);\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn `<b>${item.count} ${props.tooltipUnit}</b> ${lo.value.on} ${lo.value.months[ item.date.getMonth() ]} ${item.date.getFullYear()}`;\n\t\t\t\t\t} else if (props.noDataText !== false) {\n\t\t\t\t\t\treturn `<b>No ${props.tooltipUnit}</b> ${lo.value.on} ${lo.value.months[ item.date.getMonth() ]} ${item.date.getFullYear()}`;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn undefined;\n\t\t\t}\n\n\t\t\tfunction getSlicePosition(index: number) {\n\t\t\t\tif (props.vertical) {\n\t\t\t\t\treturn `translate(0, ${(SQUARE_SIZE * heatmap.value.numSlices) - ((index + 1) * SQUARE_SIZE)})`;\n\t\t\t\t}\n\t\t\t\treturn `translate(${index * SQUARE_SIZE}, 0)`;\n\t\t\t}\n\n\t\t\tfunction getItemPosition(index: number) {\n\t\t\t\tif (props.vertical) {\n\t\t\t\t\treturn `translate(${index * SQUARE_SIZE}, 0)`;\n\t\t\t\t}\n\t\t\t\treturn `translate(0, ${index * SQUARE_SIZE})`;\n\t\t\t}\n\n\t\t\tfunction getYearLabelPosition(yearIndex: number) {\n\t\t\t\tif (props.vertical) {\n\t\t\t\t\treturn { x: 0, y: (SQUARE_SIZE * heatmap.value.numSlices) - (SQUARE_SIZE * (yearIndex*2)) - (SQUARE_SIZE / 4) };\n\t\t\t\t}\n\t\t\t\treturn { x: SQUARE_SIZE * yearIndex * 2, y: SQUARE_SIZE - SQUARE_BORDER_SIZE };\n\t\t\t}\n\n\t\t\twatch([ toRef(props, 'rangeColor'), toRef(props, 'darkMode') ], ([ rc, dm ]) => {\n\t\t\t\trangeColor.value = rc || (dm ? Heatmap.DEFAULT_RANGE_COLOR_DARK : Heatmap.DEFAULT_RANGE_COLOR_LIGHT);\n\t\t\t});\n\n\t\t\twatch(vertical, v => {\n\t\t\t\tif (v) {\n\t\t\t\t\twidth.value                       = LEFT_SECTION_WIDTH + (SQUARE_SIZE * Heatmap.MONTHS_IN_ROW) + RIGHT_SECTION_WIDTH;\n\t\t\t\t\theight.value                      = TOP_SECTION_HEIGHT + (SQUARE_SIZE * heatmap.value.numSlices) + SQUARE_BORDER_SIZE;\n\t\t\t\t\tdaysLabelWrapperTransform.value   = `translate(${LEFT_SECTION_WIDTH}, 0)`;\n\t\t\t\t\tmonthsLabelWrapperTransform.value = `translate(0, ${TOP_SECTION_HEIGHT})`;\n\t\t\t\t} else {\n\t\t\t\t\twidth.value                       = LEFT_SECTION_WIDTH + (SQUARE_SIZE * heatmap.value.numSlices) + SQUARE_BORDER_SIZE;\n\t\t\t\t\theight.value                      = TOP_SECTION_HEIGHT + (SQUARE_SIZE * Heatmap.MONTHS_IN_ROW);\n\t\t\t\t\tdaysLabelWrapperTransform.value   = `translate(0, ${TOP_SECTION_HEIGHT})`;\n\t\t\t\t\tmonthsLabelWrapperTransform.value = `translate(${LEFT_SECTION_WIDTH}, 0)`;\n\t\t\t\t}\n\t\t\t}, { immediate: true });\n\n\t\t\twatch([ width, height ], ([ w, h ]) => (viewbox.value = ` 0 0 ${w} ${h}`), { immediate: true });\n\t\t\twatch([ width, height, rangeColor ], ([ w, h, rc ]) => {\n\t\t\t\tlegendWrapperTransform.value = vertical.value\n\t\t\t\t\t? `translate(${LEFT_SECTION_WIDTH + (SQUARE_SIZE * Heatmap.MONTHS_IN_ROW)}, ${TOP_SECTION_HEIGHT})`\n\t\t\t\t\t: `translate(${w - (SQUARE_SIZE * rc.length) - 30}, ${h - BOTTOM_SECTION_HEIGHT})`;\n\t\t\t}, { immediate: true });\n\n\t\t\twatch(locale, l => (lo.value = l ? { ...Heatmap.DEFAULT_LOCALE, ...l } : Heatmap.DEFAULT_LOCALE), { immediate: true });\n\t\t\twatch(rangeColor, rc => (legendViewbox.value = `0 0 ${Heatmap.SQUARE_SIZE * (rc.length + 1)} ${Heatmap.SQUARE_SIZE}`), { immediate: true });\n\n\t\t\twatch(\n\t\t\t\t[ values, tooltipUnit, tooltipFormatter, noDataText, max, rangeColor ],\n\t\t\t\t() => {\n\t\t\t\t\theatmap.value = new Heatmap(props.endDate as Date, props.values, props.max);\n\t\t\t\t\ttippyInstances.forEach((item) => item.destroy());\n\t\t\t\t\tnextTick(initTippy);\n\t\t\t\t}\n\t\t\t);\n\n\t\t\tonMounted(initTippy);\n\t\t\tonBeforeUnmount(() => {\n\t\t\t\ttippySingleton?.destroy();\n\t\t\t\ttippyInstances.forEach((item) => item.destroy());\n\t\t\t});\n\n\t\t\tfunction initTippyLazy(e: MouseEvent) {\n\n\t\t\t\tif (tippySingleton\n\t\t\t\t\t&& e.target\n\t\t\t\t\t&& (e.target as HTMLElement).classList.contains('vch__day__square')\n\t\t\t\t\t&& (e.target as HTMLElement).dataset.sliceIndex !== undefined\n\t\t\t\t\t&& (e.target as HTMLElement).dataset.itemIndex !== undefined\n\t\t\t\t) {\n\n\t\t\t\t\tconst sliceIndex = Number((e.target as HTMLElement).dataset.sliceIndex),\n\t\t\t\t\t\t  itemIndex  = Number((e.target as HTMLElement).dataset.itemIndex);\n\n\t\t\t\t\tif (!isNaN(sliceIndex) && !isNaN(itemIndex)) {\n\n\t\t\t\t\t\tconst tooltip = tooltipOptions(heatmap.value.calendar[ sliceIndex ][ itemIndex ]);\n\t\t\t\t\t\tif (tooltip) {\n\n\t\t\t\t\t\t\tconst instance = tippyInstances.get(e.target as HTMLElement);\n\n\t\t\t\t\t\t\tif (instance) {\n\t\t\t\t\t\t\t\tinstance.setContent(tooltip);\n\t\t\t\t\t\t\t} else if (!instance) {\n\t\t\t\t\t\t\t\ttippyInstances.set(e.target as HTMLElement, tippy(e.target as HTMLElement, { content: tooltip } as any));\n\t\t\t\t\t\t\t\ttippySingleton.setInstances(Array.from(tippyInstances.values()));\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\treturn {\n\t\t\t\tSQUARE_BORDER_SIZE, SQUARE_SIZE, LEFT_SECTION_WIDTH, RIGHT_SECTION_WIDTH, TOP_SECTION_HEIGHT, BOTTOM_SECTION_HEIGHT,\n\t\t\t\tsvg, heatmap, now, width, height, viewbox, daysLabelWrapperTransform, monthsLabelWrapperTransform, yearWrapperTransform, legendWrapperTransform,\n\t\t\t\tlo, legendViewbox, curRangeColor: rangeColor,\n\t\t\t\tgetSlicePosition, getItemPosition, getYearLabelPosition, initTippyLazy\n\t\t\t};\n\t\t}\n\t});\n</script>\n\n<style lang=\"scss\">\n\n\t.vch__container {\n\t\t.vch__legend {\n\t\t\tdisplay: flex;\n\t\t\tjustify-content: space-between;\n\t\t\talign-items: center;\n\t\t}\n\n\t\t.vch__external-legend-wrapper {\n\t\t\tmargin: 0 8px;\n\t\t}\n\t}\n\n\tsvg.vch__wrapper {\n\t\tfont-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;\n\t\tline-height: 10px;\n\t\twidth: 100%;\n\n\t\t.vch__months__labels__wrapper text.vch__month__label {\n\t\t\tfont-size: 10px;\n\t\t}\n\n\t\t.vch__days__labels__wrapper text.vch__day__label,\n\t\t.vch__legend__wrapper text {\n\t\t\tfont-size: 9px;\n\t\t}\n\n\t\ttext.vch__month__label,\n\t\ttext.vch__day__label,\n\t\t.vch__legend__wrapper text {\n\t\t\tfill: #767676;\n\t\t}\n\n\t\trect.vch__day__square:hover {\n\t\t\tstroke: #555;\n\t\t\tstroke-width: 2px;\n\t\t\tpaint-order: stroke;\n\t\t}\n\n\t\trect.vch__day__square:focus {\n\t\t\toutline: none;\n\t\t}\n\n\t\t&.dark-mode {\n\t\t\ttext.vch__month__label,\n\t\t\ttext.vch__day__label,\n\t\t\t.vch__legend__wrapper text {\n\t\t\t\tfill: #fff;\n\t\t\t}\n\t\t}\n\t}\n\n</style>\n","<template>\n\t<div :class=\"{'vch__container': true, 'dark-mode': darkMode}\">\n\t\t<svg class=\"vch__wrapper\" ref=\"svg\" :viewBox=\"viewbox\">\n\t\t\t<g class=\"vch__months__labels__wrapper\" :transform=\"monthsLabelWrapperTransform\">\n\t\t\t\t<text\n\t\t\t\t\tclass=\"vch__month__label\"\n\t\t\t\t\tv-for=\"(year, index) in heatmap.yearsToHaveInlabels\"\n\t\t\t\t\t:key=\"index\"\n\t\t\t\t\t:x=\"getYearLabelPosition(index).x\"\n\t\t\t\t\t:y=\"getYearLabelPosition(index).y\"\n\t\t\t\t>\n\t\t\t\t\t{{ year}}\n\t\t\t\t</text>\n\t\t\t</g>\n\n\t\t\t<!-- legend that has more, less and a few squares -->\n\t\t\t<g v-if=\"vertical\" class=\"vch__legend__wrapper\" :transform=\"legendWrapperTransform\">\n\t\t\t\t<text :x=\"SQUARE_SIZE * 1.25\" y=\"8\">{{ lo.less }}</text>\n\t\t\t\t<rect\n\t\t\t\t\tv-for=\"(color, index) in curRangeColor\"\n\t\t\t\t\t:key=\"index\"\n\t\t\t\t\t:rx=\"round\"\n\t\t\t\t\t:ry=\"round\"\n\t\t\t\t\t:style=\"{ fill: color }\"\n\t\t\t\t\t:width=\"SQUARE_SIZE - SQUARE_BORDER_SIZE\"\n\t\t\t\t\t:height=\"SQUARE_SIZE - SQUARE_BORDER_SIZE\"\n\t\t\t\t\t:x=\"SQUARE_SIZE * 1.75\"\n\t\t\t\t\t:y=\"SQUARE_SIZE * (index + 1)\"\n\t\t\t\t/>\n\t\t\t\t<text\n\t\t\t\t\t:x=\"SQUARE_SIZE * 1.25\"\n\t\t\t\t\t:y=\"SQUARE_SIZE * (curRangeColor.length + 2) - SQUARE_BORDER_SIZE\"\n\t\t\t\t>\n\t\t\t\t\t{{ lo.more }}\n\t\t\t\t</text>\n\t\t\t</g>\n\n\t\t\t<!-- colored boxes region -->\n\t\t\t<g class=\"vch__year__wrapper\" :transform=\"yearWrapperTransform\" @mouseover=\"initTippyLazy\">\n\t\t\t\t<g class=\"vch__slice__wrapper\"\n\t\t\t\t   v-for=\"(slice, sliceIndex) in heatmap.calendar\"\n\t\t\t\t   :key=\"sliceIndex\"\n\t\t\t\t   :transform=\"getSlicePosition(sliceIndex)\"\n\t\t\t\t>\n\t\t\t\t\t<!-- outer index is a slice, inner index is an item-->\n\t\t\t\t\t<template v-for=\"(item, itemIndex) in slice\" :key=\"itemIndex\">\n\t\t\t\t\t\t<rect class=\"vch__day__square\"\n\t\t\t\t\t\t\t  v-if=\"item.date < now\"\n\t\t\t\t\t\t\t  :rx=\"round\"\n\t\t\t\t\t\t\t  :ry=\"round\"\n\t\t\t\t\t\t\t  :transform=\"getItemPosition(itemIndex)\"\n\t\t\t\t\t\t\t  :width=\"SQUARE_SIZE - SQUARE_BORDER_SIZE\"\n\t\t\t\t\t\t\t  :height=\"SQUARE_SIZE - SQUARE_BORDER_SIZE\"\n\t\t\t\t\t\t\t  :style=\"{ fill: curRangeColor[item.colorIndex] }\"\n\t\t\t\t\t\t\t  :data-slice-index=\"sliceIndex\"\n\t\t\t\t\t\t\t  :data-item-index=\"itemIndex\"\n\t\t\t\t\t\t\t  @click=\"$emit('itemClick', item)\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t</template>\n\t\t\t\t</g>\n\t\t\t</g>\n\t\t</svg>\n\t\t<div class=\"vch__legend\">\n\t\t\t<slot name=\"legend\">\n\t\t\t\t<div class=\"vch__legend-left\">\n\t\t\t\t\t<slot name=\"vch__legend-left\"></slot>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"vch__legend-right\">\n\t\t\t\t\t<slot name=\"legend-right\">\n\t\t\t\t\t\t<div class=\"vch__legend\">\n\t\t\t\t\t\t\t<div>{{ lo.less }}</div>\n\t\t\t\t\t\t\t<svg v-if=\"!vertical\" class=\"vch__external-legend-wrapper\" :viewBox=\"legendViewbox\" :height=\"SQUARE_SIZE - SQUARE_BORDER_SIZE\">\n\t\t\t\t\t\t\t\t<g class=\"vch__legend__wrapper\">\n\t\t\t\t\t\t\t\t\t<rect\n\t\t\t\t\t\t\t\t\t\tv-for=\"(color, index) in curRangeColor\"\n\t\t\t\t\t\t\t\t\t\t:key=\"index\"\n\t\t\t\t\t\t\t\t\t\t:rx=\"round\"\n\t\t\t\t\t\t\t\t\t\t:ry=\"round\"\n\t\t\t\t\t\t\t\t\t\t:style=\"{ fill: color }\"\n\t\t\t\t\t\t\t\t\t\t:width=\"SQUARE_SIZE - SQUARE_BORDER_SIZE\"\n\t\t\t\t\t\t\t\t\t\t:height=\"SQUARE_SIZE - SQUARE_BORDER_SIZE\"\n\t\t\t\t\t\t\t\t\t\t:x=\"SQUARE_SIZE * index\"\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t</g>\n\t\t\t\t\t\t\t</svg>\n\t\t\t\t\t\t\t<div>{{ lo.more }}</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</slot>\n\t\t\t\t</div>\n\t\t\t</slot>\n\t\t</div>\n\t</div>\n</template>\n\n<script lang=\"ts\">\n\timport { defineComponent, nextTick, onBeforeUnmount, onMounted, PropType, ref, toRef, toRefs, watch } from 'vue';\n\timport { CalendarItem, Heatmap, Locale, Month, TooltipFormatter, Value } from '@/components/Heatmap';\n\timport tippy, { createSingleton, CreateSingletonInstance, Instance } from 'tippy.js';\n\timport 'tippy.js/dist/tippy.css';\n\timport 'tippy.js/dist/svg-arrow.css';\n\n\texport default /*#__PURE__*/defineComponent({\n\t\tname : 'CalendarHeatmap',\n\t\tprops: {\n\t\t\tendDate         : {\n\t\t\t\trequired: true\n\t\t\t},\n\t\t\tmax             : {\n\t\t\t\ttype: Number\n\t\t\t},\n\t\t\trangeColor      : {\n\t\t\t\ttype: Array as PropType<string[]>\n\t\t\t},\n\t\t\tvalues          : {\n\t\t\t\ttype    : Array as PropType<Value[]>,\n\t\t\t\trequired: true\n\t\t\t},\n\t\t\tlocale          : {\n\t\t\t\ttype: Object as PropType<Partial<Locale>>\n\t\t\t},\n\t\t\ttooltip         : {\n\t\t\t\ttype   : Boolean,\n\t\t\t\tdefault: true\n\t\t\t},\n\t\t\ttooltipUnit     : {\n\t\t\t\ttype   : String,\n\t\t\t\tdefault: Heatmap.DEFAULT_TOOLTIP_UNIT\n\t\t\t},\n\t\t\ttooltipFormatter: {\n\t\t\t\ttype: Function as PropType<TooltipFormatter>\n\t\t\t},\n\t\t\tvertical        : {\n\t\t\t\ttype   : Boolean,\n\t\t\t\tdefault: false\n\t\t\t},\n\t\t\tnoDataText      : {\n\t\t\t\ttype   : [ Boolean, String ],\n\t\t\t\tdefault: null\n\t\t\t},\n\t\t\tround           : {\n\t\t\t\ttype   : Number,\n\t\t\t\tdefault: 0\n\t\t\t},\n\t\t\tdarkMode        : Boolean\n\t\t},\n\t\temits: [ 'itemClick' ],\n\t\tsetup(props) {\n\n\t\t\tconst SQUARE_BORDER_SIZE          = Heatmap.SQUARE_SIZE / 5,\n\t\t\t\t  SQUARE_SIZE                 = Heatmap.SQUARE_SIZE + SQUARE_BORDER_SIZE,\n\t\t\t\t  LEFT_SECTION_WIDTH          = Math.ceil(Heatmap.SQUARE_SIZE * 2.5),\n\t\t\t\t  RIGHT_SECTION_WIDTH         = SQUARE_SIZE * 3,\n\t\t\t\t  TOP_SECTION_HEIGHT          = Heatmap.SQUARE_SIZE + (Heatmap.SQUARE_SIZE / 2),\n\t\t\t\t  BOTTOM_SECTION_HEIGHT       = Heatmap.SQUARE_SIZE + (Heatmap.SQUARE_SIZE / 2),\n\t\t\t\t  yearWrapperTransform        = `translate(${LEFT_SECTION_WIDTH}, ${TOP_SECTION_HEIGHT})`,\n\n\t\t\t\t  svg                         = ref<null | SVGElement>(null),\n\t\t\t\t  now                         = ref(new Date()),\n\t\t\t\t  heatmap                     = ref(new Heatmap(props.endDate as Date, props.values, props.max)),\n\n\t\t\t\t  width                       = ref(0),\n\t\t\t\t  height                      = ref(0),\n\t\t\t\t  viewbox                     = ref('0 0 0 0'),\n\t\t\t\t  legendViewbox               = ref('0 0 0 0'),\n\t\t\t\t  daysLabelWrapperTransform   = ref(''),\n\t\t\t\t  monthsLabelWrapperTransform = ref(''),\n\t\t\t\t  legendWrapperTransform      = ref(''),\n\t\t\t\t  lo                          = ref<Locale>({} as any),\n\t\t\t\t  rangeColor                  = ref<string[]>(props.rangeColor || (props.darkMode ? Heatmap.DEFAULT_RANGE_COLOR_DARK : Heatmap.DEFAULT_RANGE_COLOR_LIGHT));\n\n\t\t\tconst { values, tooltipUnit, tooltipFormatter, noDataText, max, vertical, locale } = toRefs(props),\n\t\t\t\t  tippyInstances                                                               = new Map<HTMLElement, Instance>();\n\n\t\t\tlet tippySingleton: CreateSingletonInstance;\n\n\n\t\t\tfunction initTippy() {\n\t\t\t\ttippyInstances.clear();\n\t\t\t\tif (tippySingleton) {\n\t\t\t\t\ttippySingleton.setInstances(Array.from(tippyInstances.values()));\n\t\t\t\t} else {\n\t\t\t\t\ttippySingleton = createSingleton(Array.from(tippyInstances.values()), {\n\t\t\t\t\t\toverrides     : [],\n\t\t\t\t\t\tmoveTransition: 'transform 0.1s ease-out',\n\t\t\t\t\t\tallowHTML     : true\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tfunction tooltipOptions(item: CalendarItem) {\n\t\t\t\tif (props.tooltip) {\n\t\t\t\t\tif (item.count !== undefined) {\n\t\t\t\t\t\tif (props.tooltipFormatter) {\n\t\t\t\t\t\t\treturn props.tooltipFormatter(item, props.tooltipUnit!);\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn `<b>${item.count} ${props.tooltipUnit}</b> ${lo.value.on} ${lo.value.months[ item.date.getMonth() ]} ${item.date.getFullYear()}`;\n\t\t\t\t\t} else if (props.noDataText !== false) {\n\t\t\t\t\t\treturn `<b>No ${props.tooltipUnit}</b> ${lo.value.on} ${lo.value.months[ item.date.getMonth() ]} ${item.date.getFullYear()}`;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn undefined;\n\t\t\t}\n\n\t\t\tfunction getSlicePosition(index: number) {\n\t\t\t\tif (props.vertical) {\n\t\t\t\t\treturn `translate(0, ${(SQUARE_SIZE * heatmap.value.numSlices) - ((index + 1) * SQUARE_SIZE)})`;\n\t\t\t\t}\n\t\t\t\treturn `translate(${index * SQUARE_SIZE}, 0)`;\n\t\t\t}\n\n\t\t\tfunction getItemPosition(index: number) {\n\t\t\t\tif (props.vertical) {\n\t\t\t\t\treturn `translate(${index * SQUARE_SIZE}, 0)`;\n\t\t\t\t}\n\t\t\t\treturn `translate(0, ${index * SQUARE_SIZE})`;\n\t\t\t}\n\n\t\t\tfunction getYearLabelPosition(yearIndex: number) {\n\t\t\t\tif (props.vertical) {\n\t\t\t\t\treturn { x: 0, y: (SQUARE_SIZE * heatmap.value.numSlices) - (SQUARE_SIZE * (yearIndex*2)) - (SQUARE_SIZE / 4) };\n\t\t\t\t}\n\t\t\t\treturn { x: SQUARE_SIZE * yearIndex * 2, y: SQUARE_SIZE - SQUARE_BORDER_SIZE };\n\t\t\t}\n\n\t\t\twatch([ toRef(props, 'rangeColor'), toRef(props, 'darkMode') ], ([ rc, dm ]) => {\n\t\t\t\trangeColor.value = rc || (dm ? Heatmap.DEFAULT_RANGE_COLOR_DARK : Heatmap.DEFAULT_RANGE_COLOR_LIGHT);\n\t\t\t});\n\n\t\t\twatch(vertical, v => {\n\t\t\t\tif (v) {\n\t\t\t\t\twidth.value                       = LEFT_SECTION_WIDTH + (SQUARE_SIZE * Heatmap.MONTHS_IN_ROW) + RIGHT_SECTION_WIDTH;\n\t\t\t\t\theight.value                      = TOP_SECTION_HEIGHT + (SQUARE_SIZE * heatmap.value.numSlices) + SQUARE_BORDER_SIZE;\n\t\t\t\t\tdaysLabelWrapperTransform.value   = `translate(${LEFT_SECTION_WIDTH}, 0)`;\n\t\t\t\t\tmonthsLabelWrapperTransform.value = `translate(0, ${TOP_SECTION_HEIGHT})`;\n\t\t\t\t} else {\n\t\t\t\t\twidth.value                       = LEFT_SECTION_WIDTH + (SQUARE_SIZE * heatmap.value.numSlices) + SQUARE_BORDER_SIZE;\n\t\t\t\t\theight.value                      = TOP_SECTION_HEIGHT + (SQUARE_SIZE * Heatmap.MONTHS_IN_ROW);\n\t\t\t\t\tdaysLabelWrapperTransform.value   = `translate(0, ${TOP_SECTION_HEIGHT})`;\n\t\t\t\t\tmonthsLabelWrapperTransform.value = `translate(${LEFT_SECTION_WIDTH}, 0)`;\n\t\t\t\t}\n\t\t\t}, { immediate: true });\n\n\t\t\twatch([ width, height ], ([ w, h ]) => (viewbox.value = ` 0 0 ${w} ${h}`), { immediate: true });\n\t\t\twatch([ width, height, rangeColor ], ([ w, h, rc ]) => {\n\t\t\t\tlegendWrapperTransform.value = vertical.value\n\t\t\t\t\t? `translate(${LEFT_SECTION_WIDTH + (SQUARE_SIZE * Heatmap.MONTHS_IN_ROW)}, ${TOP_SECTION_HEIGHT})`\n\t\t\t\t\t: `translate(${w - (SQUARE_SIZE * rc.length) - 30}, ${h - BOTTOM_SECTION_HEIGHT})`;\n\t\t\t}, { immediate: true });\n\n\t\t\twatch(locale, l => (lo.value = l ? { ...Heatmap.DEFAULT_LOCALE, ...l } : Heatmap.DEFAULT_LOCALE), { immediate: true });\n\t\t\twatch(rangeColor, rc => (legendViewbox.value = `0 0 ${Heatmap.SQUARE_SIZE * (rc.length + 1)} ${Heatmap.SQUARE_SIZE}`), { immediate: true });\n\n\t\t\twatch(\n\t\t\t\t[ values, tooltipUnit, tooltipFormatter, noDataText, max, rangeColor ],\n\t\t\t\t() => {\n\t\t\t\t\theatmap.value = new Heatmap(props.endDate as Date, props.values, props.max);\n\t\t\t\t\ttippyInstances.forEach((item) => item.destroy());\n\t\t\t\t\tnextTick(initTippy);\n\t\t\t\t}\n\t\t\t);\n\n\t\t\tonMounted(initTippy);\n\t\t\tonBeforeUnmount(() => {\n\t\t\t\ttippySingleton?.destroy();\n\t\t\t\ttippyInstances.forEach((item) => item.destroy());\n\t\t\t});\n\n\t\t\tfunction initTippyLazy(e: MouseEvent) {\n\n\t\t\t\tif (tippySingleton\n\t\t\t\t\t&& e.target\n\t\t\t\t\t&& (e.target as HTMLElement).classList.contains('vch__day__square')\n\t\t\t\t\t&& (e.target as HTMLElement).dataset.sliceIndex !== undefined\n\t\t\t\t\t&& (e.target as HTMLElement).dataset.itemIndex !== undefined\n\t\t\t\t) {\n\n\t\t\t\t\tconst sliceIndex = Number((e.target as HTMLElement).dataset.sliceIndex),\n\t\t\t\t\t\t  itemIndex  = Number((e.target as HTMLElement).dataset.itemIndex);\n\n\t\t\t\t\tif (!isNaN(sliceIndex) && !isNaN(itemIndex)) {\n\n\t\t\t\t\t\tconst tooltip = tooltipOptions(heatmap.value.calendar[ sliceIndex ][ itemIndex ]);\n\t\t\t\t\t\tif (tooltip) {\n\n\t\t\t\t\t\t\tconst instance = tippyInstances.get(e.target as HTMLElement);\n\n\t\t\t\t\t\t\tif (instance) {\n\t\t\t\t\t\t\t\tinstance.setContent(tooltip);\n\t\t\t\t\t\t\t} else if (!instance) {\n\t\t\t\t\t\t\t\ttippyInstances.set(e.target as HTMLElement, tippy(e.target as HTMLElement, { content: tooltip } as any));\n\t\t\t\t\t\t\t\ttippySingleton.setInstances(Array.from(tippyInstances.values()));\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\treturn {\n\t\t\t\tSQUARE_BORDER_SIZE, SQUARE_SIZE, LEFT_SECTION_WIDTH, RIGHT_SECTION_WIDTH, TOP_SECTION_HEIGHT, BOTTOM_SECTION_HEIGHT,\n\t\t\t\tsvg, heatmap, now, width, height, viewbox, daysLabelWrapperTransform, monthsLabelWrapperTransform, yearWrapperTransform, legendWrapperTransform,\n\t\t\t\tlo, legendViewbox, curRangeColor: rangeColor,\n\t\t\t\tgetSlicePosition, getItemPosition, getYearLabelPosition, initTippyLazy\n\t\t\t};\n\t\t}\n\t});\n</script>\n\n<style lang=\"scss\">\n\n\t.vch__container {\n\t\t.vch__legend {\n\t\t\tdisplay: flex;\n\t\t\tjustify-content: space-between;\n\t\t\talign-items: center;\n\t\t}\n\n\t\t.vch__external-legend-wrapper {\n\t\t\tmargin: 0 8px;\n\t\t}\n\t}\n\n\tsvg.vch__wrapper {\n\t\tfont-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;\n\t\tline-height: 10px;\n\t\twidth: 100%;\n\n\t\t.vch__months__labels__wrapper text.vch__month__label {\n\t\t\tfont-size: 10px;\n\t\t}\n\n\t\t.vch__days__labels__wrapper text.vch__day__label,\n\t\t.vch__legend__wrapper text {\n\t\t\tfont-size: 9px;\n\t\t}\n\n\t\ttext.vch__month__label,\n\t\ttext.vch__day__label,\n\t\t.vch__legend__wrapper text {\n\t\t\tfill: #767676;\n\t\t}\n\n\t\trect.vch__day__square:hover {\n\t\t\tstroke: #555;\n\t\t\tstroke-width: 2px;\n\t\t\tpaint-order: stroke;\n\t\t}\n\n\t\trect.vch__day__square:focus {\n\t\t\toutline: none;\n\t\t}\n\n\t\t&.dark-mode {\n\t\t\ttext.vch__month__label,\n\t\t\ttext.vch__day__label,\n\t\t\t.vch__legend__wrapper text {\n\t\t\t\tfill: #fff;\n\t\t\t}\n\t\t}\n\t}\n\n</style>\n","import { App } from 'vue';\nimport CalendarHeatmap from '@/components/CalendarHeatmap.vue';\n\nfunction install(Vue: App) {\n\tVue.component(CalendarHeatmap.name!, CalendarHeatmap);\n}\n\nexport default { install };\nexport * from '@/components/Heatmap';\nexport { default as CalendarHeatmap } from '@/components/CalendarHeatmap.vue';\n"],"names":["_Heatmap","endDate","values","max","startDate","__publicField","day","oldest","v","i","len","key","newCount","_a","date","j","monthValues","year","lastYear","cal","index","lastWeek","currentWeek","count","numDays","newDate","entry","Heatmap","_sfc_main","defineComponent","props","SQUARE_BORDER_SIZE","SQUARE_SIZE","LEFT_SECTION_WIDTH","RIGHT_SECTION_WIDTH","TOP_SECTION_HEIGHT","BOTTOM_SECTION_HEIGHT","yearWrapperTransform","svg","ref","now","heatmap","width","height","viewbox","legendViewbox","daysLabelWrapperTransform","monthsLabelWrapperTransform","legendWrapperTransform","lo","rangeColor","tooltipUnit","tooltipFormatter","noDataText","vertical","locale","toRefs","tippyInstances","tippySingleton","initTippy","createSingleton","tooltipOptions","item","getSlicePosition","getItemPosition","getYearLabelPosition","yearIndex","watch","toRef","rc","dm","w","h","l","nextTick","onMounted","onBeforeUnmount","initTippyLazy","e","sliceIndex","itemIndex","tooltip","instance","tippy","_hoisted_9","_hoisted_10","_hoisted_12","_sfc_render","_ctx","_cache","$props","$setup","$data","$options","_openBlock","_createElementBlock","_createElementVNode","_Fragment","_renderList","_hoisted_2","_hoisted_5","color","_normalizeStyle","_hoisted_6","_hoisted_4","_createCommentVNode","args","slice","_hoisted_8","_hoisted_1","_hoisted_11","_renderSlot","_hoisted_13","_hoisted_14","_toDisplayString","_hoisted_16","_hoisted_15","install","Vue","CalendarHeatmap"],"mappings":"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"}