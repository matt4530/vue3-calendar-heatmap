{"version":3,"file":"vue3-calendar-heatmap.umd.js","sources":["../src/components/Heatmap.ts","../src/components/CalendarHeatmap.vue","../src/components/CalendarHeatmap.vue","../src/index.ts"],"sourcesContent":["export interface Value {\n\tdate: Date | string;\n\tcount: number;\n}\n\nexport interface Activity {\n\tcount: number;\n\tcolorIndex: number;\n}\n\nexport type Activities = Map<string, Activity>;\n\nexport interface CalendarItem {\n\tdate: Date;\n\tcount?: number;\n\tcolorIndex: number;\n}\n\n// Indexed originally, first by week then by day\n// Indexed originally, first by half-year then by month\nexport type Calendar = CalendarItem[][];\n\nexport interface Month {\n\tvalue: number;\n\tindex: number;\n}\n\nexport interface Locale {\n\tmonths: string[];\n\tdays: string[];\n\ton: string;\n\tless: string;\n\tmore: string;\n}\n\nexport type TooltipFormatter = (item: CalendarItem, unit: string) => string;\n\nexport class Heatmap {\n\n\tstatic readonly DEFAULT_RANGE_COLOR_LIGHT = ['#ebedf0', '#dae2ef', '#c0ddf9', '#73b3f3', '#3886e1', '#17459e'];\n\tstatic readonly DEFAULT_RANGE_COLOR_DARK = ['#1f1f22', '#1e334a', '#1d466c', '#1d5689', '#1d69ac', '#1B95D1'];\n\t// other color candidates\n\t// static readonly DEFAULT_RANGE_COLOR_LIGHT = [ '#ebedf0', '#9be9a8', '#40c463', '#30a14e', '#216e39' ];\n\t// static readonly DEFAULT_RANGE_COLOR_DARK  = [ '#161b22', '#0e4429', '#006d32', '#26a641', '#39d353' ];\n\t// static readonly DEFAULT_RANGE_COLOR_DARK    = [ '#011526', '#012E40', '#025959', '#02735E', '#038C65' ];\n\t// static readonly DEFAULT_RANGE_COLOR_DARK    = [ '#161b22', '#015958', '#008F8C', '#0CABA8', '#0FC2C0' ];\n\t// static readonly DEFAULT_RANGE_COLOR_DARK    = [ '#012030', '#13678A', '#45C4B0', '#9AEBA3', '#DAFDBA' ];\n\tstatic readonly DEFAULT_LOCALE: Locale = {\n\t\tmonths: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'],\n\t\tdays: ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'],\n\t\ton: 'in',\n\t\tless: 'Less',\n\t\tmore: 'More'\n\t};\n\tstatic readonly DEFAULT_TOOLTIP_UNIT = 'contributions';\n\tstatic readonly DAYS_IN_ONE_YEAR = 365;\n\tstatic readonly DAYS_IN_WEEK = 7;\n\tstatic readonly MONTHS_IN_ONE_YEAR = 12;\n\tstatic readonly MONTHS_IN_ROW = 6;\n\tstatic readonly SQUARE_SIZE = 10;\n\n\tstatic DEFAULT_HISTORY_IN_YEARS = 5; // 5 years\n\n\tstartDate: Date;\n\tendDate: Date;\n\tmax: number;\n\tnumSlices: number;\n\tnumItems: number;\n\n\tprivate _values: Value[];\n\tprivate _firstFullWeekOfMonths?: Month[];\n\tprivate _yearsToHaveInLabels?: number[];\n\tprivate _activities?: Activities;\n\tprivate _calendar?: Calendar;\n\n\tconstructor(endDate: Date | string, values: Value[], max?: number, startDate?: Date | string) {\n\t\tthis.endDate = this.parseDate(endDate);\n\n\t\tthis.max = max || Math.ceil((Math.max(...values.map(item => item.count)) / 5) * 4);\n\n\t\tif (startDate)\n\t\t\tthis.startDate = new Date(startDate);\n\t\telse {\n\t\t\tconst oldest = values.length > 0 ? Math.min(...values.map(v => this.parseDate(v.date).getFullYear())) : new Date().getFullYear() - Heatmap.DEFAULT_HISTORY_IN_YEARS\n\t\t\tthis.startDate = new Date();\n\t\t\tthis.startDate.setFullYear(oldest);\n\t\t}\n\n\n\t\tthis.numSlices = (this.endDate.getFullYear() - this.startDate.getFullYear() + 1) * 2;\n\t\tthis.numItems = Heatmap.MONTHS_IN_ROW;\n\n\t\tthis._values = values;\n\t}\n\n\tset values(v: Value[]) {\n\t\tthis.max = Math.ceil((Math.max(...v.map(item => item.count)) / 5) * 4);\n\t\tthis._values = v;\n\n\t\tconst oldest = v.length > 0 ? Math.min(...v.map(v2 => this.parseDate(v2.date).getFullYear())) : new Date().getFullYear() - Heatmap.DEFAULT_HISTORY_IN_YEARS\n\t\tthis.startDate = new Date();\n\t\tthis.startDate.setFullYear(oldest);\n\t\tthis.numSlices = (this.endDate.getFullYear() - this.startDate.getFullYear() + 1) * 2;\n\n\t\tthis._firstFullWeekOfMonths = undefined;\n\t\tthis._yearsToHaveInLabels = undefined;\n\t\tthis._calendar = undefined;\n\t\tthis._activities = undefined;\n\t}\n\n\tget values(): Value[] {\n\t\treturn this._values;\n\t}\n\n\tget activities(): Activities {\n\t\tif (!this._activities) {\n\t\t\tthis._activities = new Map();\n\t\t\tfor (let i = 0, len = this.values.length; i < len; i++) {\n\t\t\t\t//this._activities.set(this.keyDayParser(this.values[i].date), {\n\n\t\t\t\t// additive\n\t\t\t\tconst key = this.keyMonthParser(this.values[i].date);\n\t\t\t\tconst newCount = (this._activities.get(key)?.count || 0) + this.values[i].count\n\t\t\t\tthis._activities.set(key, {\n\t\t\t\t\tcount: newCount,\n\t\t\t\t\tcolorIndex: this.getColorIndex(newCount)\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t\treturn this._activities;\n\t}\n\n\tget calendar() {\n\t\tif (!this._calendar) {\n\t\t\t//let date = this.shiftDate(this.startDate, -this.getCountEmptyDaysAtStart());\n\t\t\t//date = new Date(date.getFullYear(), date.getMonth(), date.getDate());\n\t\t\tlet date = new Date(this.startDate.getFullYear(), 0, 1);\n\t\t\t//this._calendar = new Array(this.weekCount);\n\t\t\tthis._calendar = new Array(this.numSlices);\n\t\t\tfor (let i = 0, len = this._calendar.length; i < len; i++) {\n\t\t\t\t//this._calendar[i] = new Array(Heatmap.DAYS_IN_WEEK);\n\t\t\t\tthis._calendar[i] = new Array(this.numItems);\n\t\t\t\t//for (let j = 0; j < Heatmap.DAYS_IN_WEEK; j++) {\n\t\t\t\tfor (let j = 0; j < this.numItems; j++) {\n\t\t\t\t\t//const dayValues = this.activities.get(this.keyDayParser(date));\n\t\t\t\t\tconst monthValues = this.activities.get(this.keyMonthParser(date));\n\t\t\t\t\tthis._calendar![i][j] = {\n\t\t\t\t\t\tdate: new Date(date.valueOf()),\n\t\t\t\t\t\tcount: monthValues ? monthValues.count : undefined,\n\t\t\t\t\t\tcolorIndex: monthValues ? monthValues.colorIndex : 0\n\t\t\t\t\t};\n\t\t\t\t\t//date.setDate(date.getDate() + 1);\n\t\t\t\t\tdate.setMonth(date.getMonth() + 1);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn this._calendar;\n\t}\n\n\tget yearsToHaveInlabels(): number[] {\n\t\tif (!this._yearsToHaveInLabels) {\n\t\t\tthis._yearsToHaveInLabels = [];\n\n\t\t\tlet year = this.startDate.getFullYear();\n\t\t\tconst lastYear = this.endDate.getFullYear();\n\t\t\twhile (year <= lastYear) {\n\t\t\t\tthis._yearsToHaveInLabels.push(year)\n\t\t\t\tyear++\n\t\t\t}\n\t\t}\n\t\treturn this._yearsToHaveInLabels;\n\t}\n\n\tget firstFullWeekOfMonths(): Month[] {\n\t\tif (!this._firstFullWeekOfMonths) {\n\t\t\tconst cal = this.calendar;\n\t\t\tthis._firstFullWeekOfMonths = [];\n\t\t\tfor (let index = 1, len = cal.length; index < len; index++) {\n\t\t\t\tconst lastWeek = cal[index - 1][0].date,\n\t\t\t\t\tcurrentWeek = cal[index][0].date;\n\t\t\t\tif (lastWeek.getFullYear() < currentWeek.getFullYear() || lastWeek.getMonth() < currentWeek.getMonth()) {\n\t\t\t\t\tthis._firstFullWeekOfMonths.push({ value: currentWeek.getMonth(), index });\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn this._firstFullWeekOfMonths;\n\t}\n\n\tgetColorIndex(count?: number) {\n\t\tif (count === null || count === undefined) {\n\t\t\treturn 0;\n\t\t} else if (count <= 0) {\n\t\t\treturn 1;\n\t\t} else if (count >= this.max) {\n\t\t\treturn 5;\n\t\t} else {\n\t\t\treturn (Math.ceil(((count * 100) / this.max) * (0.03))) + 1;\n\t\t}\n\t}\n\n\tgetCountEmptyDaysAtStart() {\n\t\treturn this.startDate.getDay();\n\t}\n\n\tgetCountEmptyDaysAtEnd() {\n\t\treturn (Heatmap.DAYS_IN_WEEK - 1) - this.endDate.getDay();\n\t}\n\n\tgetDaysCount() {\n\t\treturn Heatmap.DAYS_IN_ONE_YEAR + 1 + this.getCountEmptyDaysAtStart() + this.getCountEmptyDaysAtEnd();\n\t}\n\n\tprivate shiftDate(date: Date | string, numDays: number) {\n\t\tconst newDate = new Date(date);\n\t\tnewDate.setDate(newDate.getDate() + numDays);\n\t\treturn newDate;\n\t}\n\n\tprivate parseDate(entry: Date | string) {\n\t\treturn (entry instanceof Date) ? entry : (new Date(entry));\n\t}\n\n\tprivate keyDayParser(date: Date | string) {\n\t\tconst day = this.parseDate(date);\n\t\treturn String(day.getFullYear()) + String(day.getMonth()).padStart(2, '0') + String(day.getDate()).padStart(2, '0');\n\t}\n\tprivate keyMonthParser(date: Date | string) {\n\t\tconst day = this.parseDate(date);\n\t\treturn String(day.getFullYear()) + String(day.getMonth()).padStart(2, '0');\n\t}\n\n}\n","<template>\n\t<div :class=\"{'vch__container': true, 'dark-mode': darkMode}\">\n\t\t<svg class=\"vch__wrapper\" ref=\"svg\" :viewBox=\"viewbox\">\n\t\t\t<g class=\"vch__months__labels__wrapper\" :transform=\"monthsLabelWrapperTransform\">\n\t\t\t\t<text\n\t\t\t\t\tclass=\"vch__month__label\"\n\t\t\t\t\tv-for=\"(year, index) in heatmap.yearsToHaveInlabels\"\n\t\t\t\t\t:key=\"index\"\n\t\t\t\t\t:x=\"getYearLabelPosition(index).x\"\n\t\t\t\t\t:y=\"getYearLabelPosition(index).y\"\n\t\t\t\t>\n\t\t\t\t\t{{ year}}\n\t\t\t\t</text>\n\t\t\t</g>\n\n\t\t\t<!-- legend that has more, less and a few squares -->\n\t\t\t<g v-if=\"vertical\" class=\"vch__legend__wrapper\" :transform=\"legendWrapperTransform\">\n\t\t\t\t<text :x=\"SQUARE_SIZE * 1.25\" y=\"8\">{{ lo.less }}</text>\n\t\t\t\t<rect\n\t\t\t\t\tv-for=\"(color, index) in curRangeColor\"\n\t\t\t\t\t:key=\"index\"\n\t\t\t\t\t:rx=\"round\"\n\t\t\t\t\t:ry=\"round\"\n\t\t\t\t\t:style=\"{ fill: color }\"\n\t\t\t\t\t:width=\"SQUARE_SIZE - SQUARE_BORDER_SIZE\"\n\t\t\t\t\t:height=\"SQUARE_SIZE - SQUARE_BORDER_SIZE\"\n\t\t\t\t\t:x=\"SQUARE_SIZE * 1.75\"\n\t\t\t\t\t:y=\"SQUARE_SIZE * (index + 1)\"\n\t\t\t\t/>\n\t\t\t\t<text\n\t\t\t\t\t:x=\"SQUARE_SIZE * 1.25\"\n\t\t\t\t\t:y=\"SQUARE_SIZE * (curRangeColor.length + 2) - SQUARE_BORDER_SIZE\"\n\t\t\t\t>\n\t\t\t\t\t{{ lo.more }}\n\t\t\t\t</text>\n\t\t\t</g>\n\n\t\t\t<!-- colored boxes region -->\n\t\t\t<g class=\"vch__year__wrapper\" :transform=\"yearWrapperTransform\" @mouseover=\"initTippyLazy\">\n\t\t\t\t<g class=\"vch__slice__wrapper\"\n\t\t\t\t   v-for=\"(slice, sliceIndex) in heatmap.calendar\"\n\t\t\t\t   :key=\"sliceIndex\"\n\t\t\t\t   :transform=\"getSlicePosition(sliceIndex)\"\n\t\t\t\t>\n\t\t\t\t\t<!-- outer index is a slice, inner index is an item-->\n\t\t\t\t\t<template v-for=\"(item, itemIndex) in slice\" :key=\"itemIndex\">\n\t\t\t\t\t\t<rect class=\"vch__day__square\"\n\t\t\t\t\t\t\t  v-if=\"item.date < now\"\n\t\t\t\t\t\t\t  :rx=\"round\"\n\t\t\t\t\t\t\t  :ry=\"round\"\n\t\t\t\t\t\t\t  :transform=\"getItemPosition(itemIndex)\"\n\t\t\t\t\t\t\t  :width=\"SQUARE_SIZE - SQUARE_BORDER_SIZE\"\n\t\t\t\t\t\t\t  :height=\"SQUARE_SIZE - SQUARE_BORDER_SIZE\"\n\t\t\t\t\t\t\t  :style=\"{ fill: curRangeColor[item.colorIndex] }\"\n\t\t\t\t\t\t\t  :data-slice-index=\"sliceIndex\"\n\t\t\t\t\t\t\t  :data-item-index=\"itemIndex\"\n\t\t\t\t\t\t\t  @click=\"$emit('itemClick', item)\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t</template>\n\t\t\t\t</g>\n\t\t\t</g>\n\t\t</svg>\n\t\t<div v-if=\"!vertical\" class=\"vch__legend\">\n\t\t\t<slot name=\"legend\">\n\t\t\t\t<div class=\"vch__legend-left\">\n\t\t\t\t\t<slot name=\"vch__legend-left\"></slot>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"vch__legend-right\">\n\t\t\t\t\t<slot name=\"legend-right\">\n\t\t\t\t\t\t<div class=\"vch__legend\">\n\t\t\t\t\t\t\t<div>{{ lo.less }}</div>\n\t\t\t\t\t\t\t<svg v-if=\"!vertical\" class=\"vch__external-legend-wrapper\" :viewBox=\"legendViewbox\" :height=\"SQUARE_SIZE - SQUARE_BORDER_SIZE\">\n\t\t\t\t\t\t\t\t<g class=\"vch__legend__wrapper\">\n\t\t\t\t\t\t\t\t\t<rect\n\t\t\t\t\t\t\t\t\t\tv-for=\"(color, index) in curRangeColor\"\n\t\t\t\t\t\t\t\t\t\t:key=\"index\"\n\t\t\t\t\t\t\t\t\t\t:rx=\"round\"\n\t\t\t\t\t\t\t\t\t\t:ry=\"round\"\n\t\t\t\t\t\t\t\t\t\t:style=\"{ fill: color }\"\n\t\t\t\t\t\t\t\t\t\t:width=\"SQUARE_SIZE - SQUARE_BORDER_SIZE\"\n\t\t\t\t\t\t\t\t\t\t:height=\"SQUARE_SIZE - SQUARE_BORDER_SIZE\"\n\t\t\t\t\t\t\t\t\t\t:x=\"SQUARE_SIZE * index\"\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t</g>\n\t\t\t\t\t\t\t</svg>\n\t\t\t\t\t\t\t<div>{{ lo.more }}</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</slot>\n\t\t\t\t</div>\n\t\t\t</slot>\n\t\t</div>\n\t</div>\n</template>\n\n<script lang=\"ts\">\n\timport { defineComponent, nextTick, onBeforeUnmount, onMounted, PropType, ref, toRef, toRefs, watch } from 'vue';\n\timport { CalendarItem, Heatmap, Locale, Month, TooltipFormatter, Value } from '@/components/Heatmap';\n\timport tippy, { createSingleton, CreateSingletonInstance, Instance } from 'tippy.js';\n\timport 'tippy.js/dist/tippy.css';\n\timport 'tippy.js/dist/svg-arrow.css';\n\n\texport default /*#__PURE__*/defineComponent({\n\t\tname : 'CalendarHeatmap',\n\t\tprops: {\n\t\t\tendDate         : {\n\t\t\t\trequired: true\n\t\t\t},\n\t\t\tmax             : {\n\t\t\t\ttype: Number\n\t\t\t},\n\t\t\tstartDate: {\n\t\t\t},\n\t\t\trangeColor      : {\n\t\t\t\ttype: Array as PropType<string[]>\n\t\t\t},\n\t\t\tvalues          : {\n\t\t\t\ttype    : Array as PropType<Value[]>,\n\t\t\t\trequired: true\n\t\t\t},\n\t\t\tlocale          : {\n\t\t\t\ttype: Object as PropType<Partial<Locale>>\n\t\t\t},\n\t\t\ttooltip         : {\n\t\t\t\ttype   : Boolean,\n\t\t\t\tdefault: true\n\t\t\t},\n\t\t\ttooltipUnit     : {\n\t\t\t\ttype   : String,\n\t\t\t\tdefault: Heatmap.DEFAULT_TOOLTIP_UNIT\n\t\t\t},\n\t\t\ttooltipFormatter: {\n\t\t\t\ttype: Function as PropType<TooltipFormatter>\n\t\t\t},\n\t\t\tvertical        : {\n\t\t\t\ttype   : Boolean,\n\t\t\t\tdefault: false\n\t\t\t},\n\t\t\tnoDataText      : {\n\t\t\t\ttype   : [ Boolean, String ],\n\t\t\t\tdefault: null\n\t\t\t},\n\t\t\tround           : {\n\t\t\t\ttype   : Number,\n\t\t\t\tdefault: 0\n\t\t\t},\n\t\t\tdarkMode        : Boolean\n\t\t},\n\t\temits: [ 'itemClick' ],\n\t\tsetup(props) {\n\n\t\t\tconst SQUARE_BORDER_SIZE          = Heatmap.SQUARE_SIZE / 5,\n\t\t\t\t  SQUARE_SIZE                 = Heatmap.SQUARE_SIZE + SQUARE_BORDER_SIZE,\n\t\t\t\t  LEFT_SECTION_WIDTH          = Math.ceil(Heatmap.SQUARE_SIZE * 2.5),\n\t\t\t\t  RIGHT_SECTION_WIDTH         = SQUARE_SIZE * 3,\n\t\t\t\t  TOP_SECTION_HEIGHT          = Heatmap.SQUARE_SIZE + (Heatmap.SQUARE_SIZE / 2),\n\t\t\t\t  BOTTOM_SECTION_HEIGHT       = Heatmap.SQUARE_SIZE + (Heatmap.SQUARE_SIZE / 2),\n\t\t\t\t  yearWrapperTransform        = `translate(${LEFT_SECTION_WIDTH}, ${TOP_SECTION_HEIGHT})`,\n\n\t\t\t\t  svg                         = ref<null | SVGElement>(null),\n\t\t\t\t  now                         = ref(new Date()),\n\t\t\t\t  heatmap                     = ref(new Heatmap(props.endDate as Date, props.values, props.max)),\n\n\t\t\t\t  width                       = ref(0),\n\t\t\t\t  height                      = ref(0),\n\t\t\t\t  viewbox                     = ref('0 0 0 0'),\n\t\t\t\t  legendViewbox               = ref('0 0 0 0'),\n\t\t\t\t  daysLabelWrapperTransform   = ref(''),\n\t\t\t\t  monthsLabelWrapperTransform = ref(''),\n\t\t\t\t  legendWrapperTransform      = ref(''),\n\t\t\t\t  lo                          = ref<Locale>({} as any),\n\t\t\t\t  rangeColor                  = ref<string[]>(props.rangeColor || (props.darkMode ? Heatmap.DEFAULT_RANGE_COLOR_DARK : Heatmap.DEFAULT_RANGE_COLOR_LIGHT));\n\n\t\t\tconst { values, tooltipUnit, tooltipFormatter, noDataText, max, vertical, locale } = toRefs(props),\n\t\t\t\t  tippyInstances                                                               = new Map<HTMLElement, Instance>();\n\n\t\t\tlet tippySingleton: CreateSingletonInstance;\n\n\n\t\t\tfunction initTippy() {\n\t\t\t\ttippyInstances.clear();\n\t\t\t\tif (tippySingleton) {\n\t\t\t\t\ttippySingleton.setInstances(Array.from(tippyInstances.values()));\n\t\t\t\t} else {\n\t\t\t\t\ttippySingleton = createSingleton(Array.from(tippyInstances.values()), {\n\t\t\t\t\t\toverrides     : [],\n\t\t\t\t\t\tmoveTransition: 'transform 0.1s ease-out',\n\t\t\t\t\t\tallowHTML     : true\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tfunction tooltipOptions(item: CalendarItem) {\n\t\t\t\tif (props.tooltip) {\n\t\t\t\t\tif (item.count !== undefined) {\n\t\t\t\t\t\tif (props.tooltipFormatter) {\n\t\t\t\t\t\t\treturn props.tooltipFormatter(item, props.tooltipUnit!);\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn `<b>${item.count} ${props.tooltipUnit}</b> ${lo.value.on} ${lo.value.months[ item.date.getMonth() ]} ${item.date.getFullYear()}`;\n\t\t\t\t\t} else if (props.noDataText !== false) {\n\t\t\t\t\t\treturn `<b>No ${props.tooltipUnit}</b> ${lo.value.on} ${lo.value.months[ item.date.getMonth() ]} ${item.date.getFullYear()}`;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn undefined;\n\t\t\t}\n\n\t\t\tfunction getSlicePosition(index: number) {\n\t\t\t\tif (props.vertical) {\n\t\t\t\t\treturn `translate(0, ${(SQUARE_SIZE * heatmap.value.numSlices) - ((index + 1) * SQUARE_SIZE)})`;\n\t\t\t\t}\n\t\t\t\treturn `translate(${index * SQUARE_SIZE}, 0)`;\n\t\t\t}\n\n\t\t\tfunction getItemPosition(index: number) {\n\t\t\t\tif (props.vertical) {\n\t\t\t\t\treturn `translate(${index * SQUARE_SIZE}, 0)`;\n\t\t\t\t}\n\t\t\t\treturn `translate(0, ${index * SQUARE_SIZE})`;\n\t\t\t}\n\n\t\t\tfunction getYearLabelPosition(yearIndex: number) {\n\t\t\t\tif (props.vertical) {\n\t\t\t\t\treturn { x: 0, y: (SQUARE_SIZE * heatmap.value.numSlices) - (SQUARE_SIZE * (yearIndex*2)) - (SQUARE_SIZE / 4) };\n\t\t\t\t}\n\t\t\t\treturn { x: SQUARE_SIZE * yearIndex * 2, y: SQUARE_SIZE - SQUARE_BORDER_SIZE };\n\t\t\t}\n\n\t\t\tfunction resize() {\n\t\t\t\tif (vertical.value) {\n\t\t\t\t\twidth.value                       = LEFT_SECTION_WIDTH + (SQUARE_SIZE * Heatmap.MONTHS_IN_ROW) + RIGHT_SECTION_WIDTH;\n\t\t\t\t\theight.value                      = TOP_SECTION_HEIGHT + (SQUARE_SIZE * heatmap.value.numSlices) + SQUARE_BORDER_SIZE;\n\t\t\t\t\tdaysLabelWrapperTransform.value   = `translate(${LEFT_SECTION_WIDTH}, 0)`;\n\t\t\t\t\tmonthsLabelWrapperTransform.value = `translate(0, ${TOP_SECTION_HEIGHT})`;\n\t\t\t\t} else {\n\t\t\t\t\twidth.value                       = LEFT_SECTION_WIDTH + (SQUARE_SIZE * heatmap.value.numSlices) + SQUARE_BORDER_SIZE;\n\t\t\t\t\theight.value                      = TOP_SECTION_HEIGHT + (SQUARE_SIZE * Heatmap.MONTHS_IN_ROW);\n\t\t\t\t\tdaysLabelWrapperTransform.value   = `translate(0, ${TOP_SECTION_HEIGHT})`;\n\t\t\t\t\tmonthsLabelWrapperTransform.value = `translate(${LEFT_SECTION_WIDTH}, 0)`;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\twatch([ toRef(props, 'rangeColor'), toRef(props, 'darkMode') ], ([ rc, dm ]) => {\n\t\t\t\trangeColor.value = rc || (dm ? Heatmap.DEFAULT_RANGE_COLOR_DARK : Heatmap.DEFAULT_RANGE_COLOR_LIGHT);\n\t\t\t});\n\n\t\t\twatch(vertical, v => {\n\t\t\t\tresize();\n\t\t\t}, { immediate: true });\n\n\t\t\twatch([ width, height ], ([ w, h ]) => {\n\t\t\t\tif(vertical.value) {\n\t\t\t\t\tif(h < 119)\n\t\t\t\t\t\th = 119;\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tif(w < 175)\n\t\t\t\t\t\tw = 175;\n\t\t\t\t}\n\t\t\t\tviewbox.value = ` 0 0 ${w} ${h}`\n\t\t\t}, { immediate: true });\n\t\t\twatch([ width, height, rangeColor ], ([ w, h, rc ]) => {\n\t\t\t\tlegendWrapperTransform.value = vertical.value\n\t\t\t\t\t? `translate(${LEFT_SECTION_WIDTH + (SQUARE_SIZE * Heatmap.MONTHS_IN_ROW)}, ${TOP_SECTION_HEIGHT})`\n\t\t\t\t\t: `translate(${w - (SQUARE_SIZE * rc.length) - 30}, ${h - BOTTOM_SECTION_HEIGHT})`;\n\t\t\t}, { immediate: true });\n\n\t\t\twatch(locale, l => (lo.value = l ? { ...Heatmap.DEFAULT_LOCALE, ...l } : Heatmap.DEFAULT_LOCALE), { immediate: true });\n\t\t\twatch(rangeColor, rc => (legendViewbox.value = `0 0 ${Heatmap.SQUARE_SIZE * (rc.length + 1)} ${Heatmap.SQUARE_SIZE}`), { immediate: true });\n\n\t\t\twatch(\n\t\t\t\t[ values, tooltipUnit, tooltipFormatter, noDataText, max, rangeColor ],\n\t\t\t\t() => {\n\t\t\t\t\theatmap.value = new Heatmap(props.endDate as Date, props.values, props.max);\n\t\t\t\t\ttippyInstances.forEach((item) => item.destroy());\n\t\t\t\t\tnextTick(initTippy);\n\t\t\t\t\tresize();\n\t\t\t\t}\n\t\t\t\t, {deep:true});\n\n\t\t\tonMounted(initTippy);\n\t\t\tonBeforeUnmount(() => {\n\t\t\t\ttippySingleton?.destroy();\n\t\t\t\ttippyInstances.forEach((item) => item.destroy());\n\t\t\t});\n\n\t\t\tfunction initTippyLazy(e: MouseEvent) {\n\n\t\t\t\tif (tippySingleton\n\t\t\t\t\t&& e.target\n\t\t\t\t\t&& (e.target as HTMLElement).classList.contains('vch__day__square')\n\t\t\t\t\t&& (e.target as HTMLElement).dataset.sliceIndex !== undefined\n\t\t\t\t\t&& (e.target as HTMLElement).dataset.itemIndex !== undefined\n\t\t\t\t) {\n\n\t\t\t\t\tconst sliceIndex = Number((e.target as HTMLElement).dataset.sliceIndex),\n\t\t\t\t\t\t  itemIndex  = Number((e.target as HTMLElement).dataset.itemIndex);\n\n\t\t\t\t\tif (!isNaN(sliceIndex) && !isNaN(itemIndex)) {\n\n\t\t\t\t\t\tconst tooltip = tooltipOptions(heatmap.value.calendar[ sliceIndex ][ itemIndex ]);\n\t\t\t\t\t\tif (tooltip) {\n\n\t\t\t\t\t\t\tconst instance = tippyInstances.get(e.target as HTMLElement);\n\n\t\t\t\t\t\t\tif (instance) {\n\t\t\t\t\t\t\t\tinstance.setContent(tooltip);\n\t\t\t\t\t\t\t} else if (!instance) {\n\t\t\t\t\t\t\t\ttippyInstances.set(e.target as HTMLElement, tippy(e.target as HTMLElement, { content: tooltip } as any));\n\t\t\t\t\t\t\t\ttippySingleton.setInstances(Array.from(tippyInstances.values()));\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\treturn {\n\t\t\t\tSQUARE_BORDER_SIZE, SQUARE_SIZE, LEFT_SECTION_WIDTH, RIGHT_SECTION_WIDTH, TOP_SECTION_HEIGHT, BOTTOM_SECTION_HEIGHT,\n\t\t\t\tsvg, heatmap, now, width, height, viewbox, daysLabelWrapperTransform, monthsLabelWrapperTransform, yearWrapperTransform, legendWrapperTransform,\n\t\t\t\tlo, legendViewbox, curRangeColor: rangeColor,\n\t\t\t\tgetSlicePosition, getItemPosition, getYearLabelPosition, initTippyLazy\n\t\t\t};\n\t\t}\n\t});\n</script>\n\n<style lang=\"scss\">\n\n\t.vch__container {\n\t\t.vch__legend {\n\t\t\tdisplay: flex;\n\t\t\tjustify-content: space-between;\n\t\t\talign-items: center;\n\t\t}\n\n\t\t.vch__external-legend-wrapper {\n\t\t\tmargin: 0 8px;\n\t\t}\n\t}\n\n\tsvg.vch__wrapper {\n\t\tfont-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;\n\t\tline-height: 10px;\n\t\twidth: 100%;\n\n\t\t.vch__months__labels__wrapper text.vch__month__label {\n\t\t\tfont-size: 10px;\n\t\t}\n\n\t\t.vch__days__labels__wrapper text.vch__day__label,\n\t\t.vch__legend__wrapper text {\n\t\t\tfont-size: 9px;\n\t\t}\n\n\t\ttext.vch__month__label,\n\t\ttext.vch__day__label,\n\t\t.vch__legend__wrapper text {\n\t\t\tfill: #767676;\n\t\t}\n\n\t\trect.vch__day__square:hover {\n\t\t\tstroke: #555;\n\t\t\tstroke-width: 2px;\n\t\t\tpaint-order: stroke;\n\t\t}\n\n\t\trect.vch__day__square:focus {\n\t\t\toutline: none;\n\t\t}\n\n\t\t&.dark-mode {\n\t\t\ttext.vch__month__label,\n\t\t\ttext.vch__day__label,\n\t\t\t.vch__legend__wrapper text {\n\t\t\t\tfill: #fff;\n\t\t\t}\n\t\t}\n\t}\n\n</style>\n","<template>\n\t<div :class=\"{'vch__container': true, 'dark-mode': darkMode}\">\n\t\t<svg class=\"vch__wrapper\" ref=\"svg\" :viewBox=\"viewbox\">\n\t\t\t<g class=\"vch__months__labels__wrapper\" :transform=\"monthsLabelWrapperTransform\">\n\t\t\t\t<text\n\t\t\t\t\tclass=\"vch__month__label\"\n\t\t\t\t\tv-for=\"(year, index) in heatmap.yearsToHaveInlabels\"\n\t\t\t\t\t:key=\"index\"\n\t\t\t\t\t:x=\"getYearLabelPosition(index).x\"\n\t\t\t\t\t:y=\"getYearLabelPosition(index).y\"\n\t\t\t\t>\n\t\t\t\t\t{{ year}}\n\t\t\t\t</text>\n\t\t\t</g>\n\n\t\t\t<!-- legend that has more, less and a few squares -->\n\t\t\t<g v-if=\"vertical\" class=\"vch__legend__wrapper\" :transform=\"legendWrapperTransform\">\n\t\t\t\t<text :x=\"SQUARE_SIZE * 1.25\" y=\"8\">{{ lo.less }}</text>\n\t\t\t\t<rect\n\t\t\t\t\tv-for=\"(color, index) in curRangeColor\"\n\t\t\t\t\t:key=\"index\"\n\t\t\t\t\t:rx=\"round\"\n\t\t\t\t\t:ry=\"round\"\n\t\t\t\t\t:style=\"{ fill: color }\"\n\t\t\t\t\t:width=\"SQUARE_SIZE - SQUARE_BORDER_SIZE\"\n\t\t\t\t\t:height=\"SQUARE_SIZE - SQUARE_BORDER_SIZE\"\n\t\t\t\t\t:x=\"SQUARE_SIZE * 1.75\"\n\t\t\t\t\t:y=\"SQUARE_SIZE * (index + 1)\"\n\t\t\t\t/>\n\t\t\t\t<text\n\t\t\t\t\t:x=\"SQUARE_SIZE * 1.25\"\n\t\t\t\t\t:y=\"SQUARE_SIZE * (curRangeColor.length + 2) - SQUARE_BORDER_SIZE\"\n\t\t\t\t>\n\t\t\t\t\t{{ lo.more }}\n\t\t\t\t</text>\n\t\t\t</g>\n\n\t\t\t<!-- colored boxes region -->\n\t\t\t<g class=\"vch__year__wrapper\" :transform=\"yearWrapperTransform\" @mouseover=\"initTippyLazy\">\n\t\t\t\t<g class=\"vch__slice__wrapper\"\n\t\t\t\t   v-for=\"(slice, sliceIndex) in heatmap.calendar\"\n\t\t\t\t   :key=\"sliceIndex\"\n\t\t\t\t   :transform=\"getSlicePosition(sliceIndex)\"\n\t\t\t\t>\n\t\t\t\t\t<!-- outer index is a slice, inner index is an item-->\n\t\t\t\t\t<template v-for=\"(item, itemIndex) in slice\" :key=\"itemIndex\">\n\t\t\t\t\t\t<rect class=\"vch__day__square\"\n\t\t\t\t\t\t\t  v-if=\"item.date < now\"\n\t\t\t\t\t\t\t  :rx=\"round\"\n\t\t\t\t\t\t\t  :ry=\"round\"\n\t\t\t\t\t\t\t  :transform=\"getItemPosition(itemIndex)\"\n\t\t\t\t\t\t\t  :width=\"SQUARE_SIZE - SQUARE_BORDER_SIZE\"\n\t\t\t\t\t\t\t  :height=\"SQUARE_SIZE - SQUARE_BORDER_SIZE\"\n\t\t\t\t\t\t\t  :style=\"{ fill: curRangeColor[item.colorIndex] }\"\n\t\t\t\t\t\t\t  :data-slice-index=\"sliceIndex\"\n\t\t\t\t\t\t\t  :data-item-index=\"itemIndex\"\n\t\t\t\t\t\t\t  @click=\"$emit('itemClick', item)\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t</template>\n\t\t\t\t</g>\n\t\t\t</g>\n\t\t</svg>\n\t\t<div v-if=\"!vertical\" class=\"vch__legend\">\n\t\t\t<slot name=\"legend\">\n\t\t\t\t<div class=\"vch__legend-left\">\n\t\t\t\t\t<slot name=\"vch__legend-left\"></slot>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"vch__legend-right\">\n\t\t\t\t\t<slot name=\"legend-right\">\n\t\t\t\t\t\t<div class=\"vch__legend\">\n\t\t\t\t\t\t\t<div>{{ lo.less }}</div>\n\t\t\t\t\t\t\t<svg v-if=\"!vertical\" class=\"vch__external-legend-wrapper\" :viewBox=\"legendViewbox\" :height=\"SQUARE_SIZE - SQUARE_BORDER_SIZE\">\n\t\t\t\t\t\t\t\t<g class=\"vch__legend__wrapper\">\n\t\t\t\t\t\t\t\t\t<rect\n\t\t\t\t\t\t\t\t\t\tv-for=\"(color, index) in curRangeColor\"\n\t\t\t\t\t\t\t\t\t\t:key=\"index\"\n\t\t\t\t\t\t\t\t\t\t:rx=\"round\"\n\t\t\t\t\t\t\t\t\t\t:ry=\"round\"\n\t\t\t\t\t\t\t\t\t\t:style=\"{ fill: color }\"\n\t\t\t\t\t\t\t\t\t\t:width=\"SQUARE_SIZE - SQUARE_BORDER_SIZE\"\n\t\t\t\t\t\t\t\t\t\t:height=\"SQUARE_SIZE - SQUARE_BORDER_SIZE\"\n\t\t\t\t\t\t\t\t\t\t:x=\"SQUARE_SIZE * index\"\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t</g>\n\t\t\t\t\t\t\t</svg>\n\t\t\t\t\t\t\t<div>{{ lo.more }}</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</slot>\n\t\t\t\t</div>\n\t\t\t</slot>\n\t\t</div>\n\t</div>\n</template>\n\n<script lang=\"ts\">\n\timport { defineComponent, nextTick, onBeforeUnmount, onMounted, PropType, ref, toRef, toRefs, watch } from 'vue';\n\timport { CalendarItem, Heatmap, Locale, Month, TooltipFormatter, Value } from '@/components/Heatmap';\n\timport tippy, { createSingleton, CreateSingletonInstance, Instance } from 'tippy.js';\n\timport 'tippy.js/dist/tippy.css';\n\timport 'tippy.js/dist/svg-arrow.css';\n\n\texport default /*#__PURE__*/defineComponent({\n\t\tname : 'CalendarHeatmap',\n\t\tprops: {\n\t\t\tendDate         : {\n\t\t\t\trequired: true\n\t\t\t},\n\t\t\tmax             : {\n\t\t\t\ttype: Number\n\t\t\t},\n\t\t\tstartDate: {\n\t\t\t},\n\t\t\trangeColor      : {\n\t\t\t\ttype: Array as PropType<string[]>\n\t\t\t},\n\t\t\tvalues          : {\n\t\t\t\ttype    : Array as PropType<Value[]>,\n\t\t\t\trequired: true\n\t\t\t},\n\t\t\tlocale          : {\n\t\t\t\ttype: Object as PropType<Partial<Locale>>\n\t\t\t},\n\t\t\ttooltip         : {\n\t\t\t\ttype   : Boolean,\n\t\t\t\tdefault: true\n\t\t\t},\n\t\t\ttooltipUnit     : {\n\t\t\t\ttype   : String,\n\t\t\t\tdefault: Heatmap.DEFAULT_TOOLTIP_UNIT\n\t\t\t},\n\t\t\ttooltipFormatter: {\n\t\t\t\ttype: Function as PropType<TooltipFormatter>\n\t\t\t},\n\t\t\tvertical        : {\n\t\t\t\ttype   : Boolean,\n\t\t\t\tdefault: false\n\t\t\t},\n\t\t\tnoDataText      : {\n\t\t\t\ttype   : [ Boolean, String ],\n\t\t\t\tdefault: null\n\t\t\t},\n\t\t\tround           : {\n\t\t\t\ttype   : Number,\n\t\t\t\tdefault: 0\n\t\t\t},\n\t\t\tdarkMode        : Boolean\n\t\t},\n\t\temits: [ 'itemClick' ],\n\t\tsetup(props) {\n\n\t\t\tconst SQUARE_BORDER_SIZE          = Heatmap.SQUARE_SIZE / 5,\n\t\t\t\t  SQUARE_SIZE                 = Heatmap.SQUARE_SIZE + SQUARE_BORDER_SIZE,\n\t\t\t\t  LEFT_SECTION_WIDTH          = Math.ceil(Heatmap.SQUARE_SIZE * 2.5),\n\t\t\t\t  RIGHT_SECTION_WIDTH         = SQUARE_SIZE * 3,\n\t\t\t\t  TOP_SECTION_HEIGHT          = Heatmap.SQUARE_SIZE + (Heatmap.SQUARE_SIZE / 2),\n\t\t\t\t  BOTTOM_SECTION_HEIGHT       = Heatmap.SQUARE_SIZE + (Heatmap.SQUARE_SIZE / 2),\n\t\t\t\t  yearWrapperTransform        = `translate(${LEFT_SECTION_WIDTH}, ${TOP_SECTION_HEIGHT})`,\n\n\t\t\t\t  svg                         = ref<null | SVGElement>(null),\n\t\t\t\t  now                         = ref(new Date()),\n\t\t\t\t  heatmap                     = ref(new Heatmap(props.endDate as Date, props.values, props.max)),\n\n\t\t\t\t  width                       = ref(0),\n\t\t\t\t  height                      = ref(0),\n\t\t\t\t  viewbox                     = ref('0 0 0 0'),\n\t\t\t\t  legendViewbox               = ref('0 0 0 0'),\n\t\t\t\t  daysLabelWrapperTransform   = ref(''),\n\t\t\t\t  monthsLabelWrapperTransform = ref(''),\n\t\t\t\t  legendWrapperTransform      = ref(''),\n\t\t\t\t  lo                          = ref<Locale>({} as any),\n\t\t\t\t  rangeColor                  = ref<string[]>(props.rangeColor || (props.darkMode ? Heatmap.DEFAULT_RANGE_COLOR_DARK : Heatmap.DEFAULT_RANGE_COLOR_LIGHT));\n\n\t\t\tconst { values, tooltipUnit, tooltipFormatter, noDataText, max, vertical, locale } = toRefs(props),\n\t\t\t\t  tippyInstances                                                               = new Map<HTMLElement, Instance>();\n\n\t\t\tlet tippySingleton: CreateSingletonInstance;\n\n\n\t\t\tfunction initTippy() {\n\t\t\t\ttippyInstances.clear();\n\t\t\t\tif (tippySingleton) {\n\t\t\t\t\ttippySingleton.setInstances(Array.from(tippyInstances.values()));\n\t\t\t\t} else {\n\t\t\t\t\ttippySingleton = createSingleton(Array.from(tippyInstances.values()), {\n\t\t\t\t\t\toverrides     : [],\n\t\t\t\t\t\tmoveTransition: 'transform 0.1s ease-out',\n\t\t\t\t\t\tallowHTML     : true\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tfunction tooltipOptions(item: CalendarItem) {\n\t\t\t\tif (props.tooltip) {\n\t\t\t\t\tif (item.count !== undefined) {\n\t\t\t\t\t\tif (props.tooltipFormatter) {\n\t\t\t\t\t\t\treturn props.tooltipFormatter(item, props.tooltipUnit!);\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn `<b>${item.count} ${props.tooltipUnit}</b> ${lo.value.on} ${lo.value.months[ item.date.getMonth() ]} ${item.date.getFullYear()}`;\n\t\t\t\t\t} else if (props.noDataText !== false) {\n\t\t\t\t\t\treturn `<b>No ${props.tooltipUnit}</b> ${lo.value.on} ${lo.value.months[ item.date.getMonth() ]} ${item.date.getFullYear()}`;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn undefined;\n\t\t\t}\n\n\t\t\tfunction getSlicePosition(index: number) {\n\t\t\t\tif (props.vertical) {\n\t\t\t\t\treturn `translate(0, ${(SQUARE_SIZE * heatmap.value.numSlices) - ((index + 1) * SQUARE_SIZE)})`;\n\t\t\t\t}\n\t\t\t\treturn `translate(${index * SQUARE_SIZE}, 0)`;\n\t\t\t}\n\n\t\t\tfunction getItemPosition(index: number) {\n\t\t\t\tif (props.vertical) {\n\t\t\t\t\treturn `translate(${index * SQUARE_SIZE}, 0)`;\n\t\t\t\t}\n\t\t\t\treturn `translate(0, ${index * SQUARE_SIZE})`;\n\t\t\t}\n\n\t\t\tfunction getYearLabelPosition(yearIndex: number) {\n\t\t\t\tif (props.vertical) {\n\t\t\t\t\treturn { x: 0, y: (SQUARE_SIZE * heatmap.value.numSlices) - (SQUARE_SIZE * (yearIndex*2)) - (SQUARE_SIZE / 4) };\n\t\t\t\t}\n\t\t\t\treturn { x: SQUARE_SIZE * yearIndex * 2, y: SQUARE_SIZE - SQUARE_BORDER_SIZE };\n\t\t\t}\n\n\t\t\tfunction resize() {\n\t\t\t\tif (vertical.value) {\n\t\t\t\t\twidth.value                       = LEFT_SECTION_WIDTH + (SQUARE_SIZE * Heatmap.MONTHS_IN_ROW) + RIGHT_SECTION_WIDTH;\n\t\t\t\t\theight.value                      = TOP_SECTION_HEIGHT + (SQUARE_SIZE * heatmap.value.numSlices) + SQUARE_BORDER_SIZE;\n\t\t\t\t\tdaysLabelWrapperTransform.value   = `translate(${LEFT_SECTION_WIDTH}, 0)`;\n\t\t\t\t\tmonthsLabelWrapperTransform.value = `translate(0, ${TOP_SECTION_HEIGHT})`;\n\t\t\t\t} else {\n\t\t\t\t\twidth.value                       = LEFT_SECTION_WIDTH + (SQUARE_SIZE * heatmap.value.numSlices) + SQUARE_BORDER_SIZE;\n\t\t\t\t\theight.value                      = TOP_SECTION_HEIGHT + (SQUARE_SIZE * Heatmap.MONTHS_IN_ROW);\n\t\t\t\t\tdaysLabelWrapperTransform.value   = `translate(0, ${TOP_SECTION_HEIGHT})`;\n\t\t\t\t\tmonthsLabelWrapperTransform.value = `translate(${LEFT_SECTION_WIDTH}, 0)`;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\twatch([ toRef(props, 'rangeColor'), toRef(props, 'darkMode') ], ([ rc, dm ]) => {\n\t\t\t\trangeColor.value = rc || (dm ? Heatmap.DEFAULT_RANGE_COLOR_DARK : Heatmap.DEFAULT_RANGE_COLOR_LIGHT);\n\t\t\t});\n\n\t\t\twatch(vertical, v => {\n\t\t\t\tresize();\n\t\t\t}, { immediate: true });\n\n\t\t\twatch([ width, height ], ([ w, h ]) => {\n\t\t\t\tif(vertical.value) {\n\t\t\t\t\tif(h < 119)\n\t\t\t\t\t\th = 119;\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tif(w < 175)\n\t\t\t\t\t\tw = 175;\n\t\t\t\t}\n\t\t\t\tviewbox.value = ` 0 0 ${w} ${h}`\n\t\t\t}, { immediate: true });\n\t\t\twatch([ width, height, rangeColor ], ([ w, h, rc ]) => {\n\t\t\t\tlegendWrapperTransform.value = vertical.value\n\t\t\t\t\t? `translate(${LEFT_SECTION_WIDTH + (SQUARE_SIZE * Heatmap.MONTHS_IN_ROW)}, ${TOP_SECTION_HEIGHT})`\n\t\t\t\t\t: `translate(${w - (SQUARE_SIZE * rc.length) - 30}, ${h - BOTTOM_SECTION_HEIGHT})`;\n\t\t\t}, { immediate: true });\n\n\t\t\twatch(locale, l => (lo.value = l ? { ...Heatmap.DEFAULT_LOCALE, ...l } : Heatmap.DEFAULT_LOCALE), { immediate: true });\n\t\t\twatch(rangeColor, rc => (legendViewbox.value = `0 0 ${Heatmap.SQUARE_SIZE * (rc.length + 1)} ${Heatmap.SQUARE_SIZE}`), { immediate: true });\n\n\t\t\twatch(\n\t\t\t\t[ values, tooltipUnit, tooltipFormatter, noDataText, max, rangeColor ],\n\t\t\t\t() => {\n\t\t\t\t\theatmap.value = new Heatmap(props.endDate as Date, props.values, props.max);\n\t\t\t\t\ttippyInstances.forEach((item) => item.destroy());\n\t\t\t\t\tnextTick(initTippy);\n\t\t\t\t\tresize();\n\t\t\t\t}\n\t\t\t\t, {deep:true});\n\n\t\t\tonMounted(initTippy);\n\t\t\tonBeforeUnmount(() => {\n\t\t\t\ttippySingleton?.destroy();\n\t\t\t\ttippyInstances.forEach((item) => item.destroy());\n\t\t\t});\n\n\t\t\tfunction initTippyLazy(e: MouseEvent) {\n\n\t\t\t\tif (tippySingleton\n\t\t\t\t\t&& e.target\n\t\t\t\t\t&& (e.target as HTMLElement).classList.contains('vch__day__square')\n\t\t\t\t\t&& (e.target as HTMLElement).dataset.sliceIndex !== undefined\n\t\t\t\t\t&& (e.target as HTMLElement).dataset.itemIndex !== undefined\n\t\t\t\t) {\n\n\t\t\t\t\tconst sliceIndex = Number((e.target as HTMLElement).dataset.sliceIndex),\n\t\t\t\t\t\t  itemIndex  = Number((e.target as HTMLElement).dataset.itemIndex);\n\n\t\t\t\t\tif (!isNaN(sliceIndex) && !isNaN(itemIndex)) {\n\n\t\t\t\t\t\tconst tooltip = tooltipOptions(heatmap.value.calendar[ sliceIndex ][ itemIndex ]);\n\t\t\t\t\t\tif (tooltip) {\n\n\t\t\t\t\t\t\tconst instance = tippyInstances.get(e.target as HTMLElement);\n\n\t\t\t\t\t\t\tif (instance) {\n\t\t\t\t\t\t\t\tinstance.setContent(tooltip);\n\t\t\t\t\t\t\t} else if (!instance) {\n\t\t\t\t\t\t\t\ttippyInstances.set(e.target as HTMLElement, tippy(e.target as HTMLElement, { content: tooltip } as any));\n\t\t\t\t\t\t\t\ttippySingleton.setInstances(Array.from(tippyInstances.values()));\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\treturn {\n\t\t\t\tSQUARE_BORDER_SIZE, SQUARE_SIZE, LEFT_SECTION_WIDTH, RIGHT_SECTION_WIDTH, TOP_SECTION_HEIGHT, BOTTOM_SECTION_HEIGHT,\n\t\t\t\tsvg, heatmap, now, width, height, viewbox, daysLabelWrapperTransform, monthsLabelWrapperTransform, yearWrapperTransform, legendWrapperTransform,\n\t\t\t\tlo, legendViewbox, curRangeColor: rangeColor,\n\t\t\t\tgetSlicePosition, getItemPosition, getYearLabelPosition, initTippyLazy\n\t\t\t};\n\t\t}\n\t});\n</script>\n\n<style lang=\"scss\">\n\n\t.vch__container {\n\t\t.vch__legend {\n\t\t\tdisplay: flex;\n\t\t\tjustify-content: space-between;\n\t\t\talign-items: center;\n\t\t}\n\n\t\t.vch__external-legend-wrapper {\n\t\t\tmargin: 0 8px;\n\t\t}\n\t}\n\n\tsvg.vch__wrapper {\n\t\tfont-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;\n\t\tline-height: 10px;\n\t\twidth: 100%;\n\n\t\t.vch__months__labels__wrapper text.vch__month__label {\n\t\t\tfont-size: 10px;\n\t\t}\n\n\t\t.vch__days__labels__wrapper text.vch__day__label,\n\t\t.vch__legend__wrapper text {\n\t\t\tfont-size: 9px;\n\t\t}\n\n\t\ttext.vch__month__label,\n\t\ttext.vch__day__label,\n\t\t.vch__legend__wrapper text {\n\t\t\tfill: #767676;\n\t\t}\n\n\t\trect.vch__day__square:hover {\n\t\t\tstroke: #555;\n\t\t\tstroke-width: 2px;\n\t\t\tpaint-order: stroke;\n\t\t}\n\n\t\trect.vch__day__square:focus {\n\t\t\toutline: none;\n\t\t}\n\n\t\t&.dark-mode {\n\t\t\ttext.vch__month__label,\n\t\t\ttext.vch__day__label,\n\t\t\t.vch__legend__wrapper text {\n\t\t\t\tfill: #fff;\n\t\t\t}\n\t\t}\n\t}\n\n</style>\n","import { App } from 'vue';\nimport CalendarHeatmap from '@/components/CalendarHeatmap.vue';\n\nfunction install(Vue: App) {\n\tVue.component(CalendarHeatmap.name!, CalendarHeatmap);\n}\n\nexport default { install };\nexport * from '@/components/Heatmap';\nexport { default as CalendarHeatmap } from '@/components/CalendarHeatmap.vue';\n"],"names":["_Heatmap","endDate","values","max","startDate","__publicField","item","oldest","v","v2","i","len","key","newCount","_a","date","j","monthValues","year","lastYear","cal","index","lastWeek","currentWeek","count","numDays","newDate","entry","day","Heatmap","_sfc_main","defineComponent","props","SQUARE_BORDER_SIZE","SQUARE_SIZE","LEFT_SECTION_WIDTH","RIGHT_SECTION_WIDTH","TOP_SECTION_HEIGHT","BOTTOM_SECTION_HEIGHT","yearWrapperTransform","svg","ref","now","heatmap","width","height","viewbox","legendViewbox","daysLabelWrapperTransform","monthsLabelWrapperTransform","legendWrapperTransform","lo","rangeColor","tooltipUnit","tooltipFormatter","noDataText","vertical","locale","toRefs","tippyInstances","tippySingleton","initTippy","createSingleton","tooltipOptions","getSlicePosition","getItemPosition","getYearLabelPosition","yearIndex","resize","watch","toRef","rc","dm","w","h","l","nextTick","onMounted","onBeforeUnmount","initTippyLazy","e","sliceIndex","itemIndex","tooltip","instance","tippy","_hoisted_11","_hoisted_12","_sfc_render","_ctx","_cache","$props","$setup","$data","$options","_openBlock","_createElementBlock","_createElementVNode","_Fragment","_renderList","_hoisted_2","_hoisted_5","color","_normalizeStyle","_hoisted_6","_hoisted_4","_createCommentVNode","args","slice","_hoisted_8","_hoisted_1","_renderSlot","_hoisted_13","_hoisted_14","_toDisplayString","_hoisted_16","_hoisted_15","install","Vue","CalendarHeatmap"],"mappings":"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"}